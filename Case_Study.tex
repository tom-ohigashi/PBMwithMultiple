% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
%
\documentclass[
]{article}
\usepackage{amsmath,amssymb}
\usepackage{iftex}
\ifPDFTeX
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math} % this also loads fontspec
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
\usepackage{lmodern}
\ifPDFTeX\else
  % xetex/luatex font selection
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\usepackage{graphicx}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother
\setlength{\emergencystretch}{3em} % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{5}
\usepackage{siunitx}
\usepackage{zxjatype}
\usepackage{booktabs}
\usepackage{threeparttable}
\usepackage{threeparttablex}
\usepackage{array}
\usepackage{multirow}
\usepackage[ipaex]{zxjafont}
\usepackage[left=30mm,right=30mm,bottom=30mm,top=35mm]{geometry}
\usepackage{float} \floatplacement{figure}{H}
\newcommand{\beginsupplement}{\setcounter{table}{0}
\renewcommand{\thetable}{S\arabic{table}}
\setcounter{figure}{0}
\renewcommand{\thefigure}{S\arabic{figure}}}
\usepackage{threeparttable}
\ifLuaTeX
  \usepackage{selnolig}  % disable illegal ligatures
\fi
\IfFileExists{bookmark.sty}{\usepackage{bookmark}}{\usepackage{hyperref}}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\urlstyle{same}
\hypersetup{
  pdftitle={Case Study for ``Potential bias models with Bayesian shrinkage priors for dynamic borrowing of multiple historical control data'\,'},
  pdfauthor={Tomohiro Ohigashi, Kazushi Maruo, Takashi Sozu, Ryo Sawamoto, Masahiko Gosho},
  hidelinks,
  pdfcreator={LaTeX via pandoc}}

\title{Case Study for ``Potential bias models with Bayesian shrinkage
priors for dynamic borrowing of multiple historical control data'\,'}
\author{Tomohiro Ohigashi, Kazushi Maruo, Takashi Sozu, Ryo Sawamoto,
Masahiko Gosho}
\date{}

\begin{document}
\maketitle

{
\setcounter{tocdepth}{2}
\tableofcontents
}
\hypertarget{required-r-packages}{%
\section{Required R packages}\label{required-r-packages}}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(tidyverse)}
\FunctionTok{library}\NormalTok{(ggpubr)}
\FunctionTok{library}\NormalTok{(rstan)}
\FunctionTok{library}\NormalTok{(cmdstanr)}
\FunctionTok{library}\NormalTok{(bayesplot)}
\FunctionTok{library}\NormalTok{(RBesT)}
\FunctionTok{options}\NormalTok{(}\AttributeTok{kableExtra.latex.load\_packages =} \ConstantTok{FALSE}\NormalTok{)}
\FunctionTok{library}\NormalTok{(kableExtra)}
\FunctionTok{library}\NormalTok{(knitr)}
\end{Highlighting}
\end{Shaded}

\hypertarget{preparation}{%
\section{Preparation}\label{preparation}}

\hypertarget{reading-stan-code}{%
\subsection{Reading Stan Code}\label{reading-stan-code}}

All Stan codes used in the case study (and simulation studies) are
stored in the ``Stan'\,' directory. In the following, these codes are
read.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{Current\_stan }\OtherTok{\textless{}{-}} \FunctionTok{cmdstan\_model}\NormalTok{(}\FunctionTok{paste0}\NormalTok{(}\FunctionTok{getwd}\NormalTok{(), }\StringTok{\textquotesingle{}/Stan/Current.stan\textquotesingle{}}\NormalTok{))}
\NormalTok{Pooled\_stan  }\OtherTok{\textless{}{-}} \FunctionTok{cmdstan\_model}\NormalTok{(}\FunctionTok{paste0}\NormalTok{(}\FunctionTok{getwd}\NormalTok{(), }\StringTok{\textquotesingle{}/Stan/Pooled.stan\textquotesingle{}}\NormalTok{))}
\NormalTok{EX\_stan      }\OtherTok{\textless{}{-}} \FunctionTok{cmdstan\_model}\NormalTok{(}\FunctionTok{paste0}\NormalTok{(}\FunctionTok{getwd}\NormalTok{(), }\StringTok{\textquotesingle{}/Stan/EX.stan\textquotesingle{}}\NormalTok{))}
\NormalTok{EXNEX\_stan   }\OtherTok{\textless{}{-}} \FunctionTok{cmdstan\_model}\NormalTok{(}\FunctionTok{paste0}\NormalTok{(}\FunctionTok{getwd}\NormalTok{(), }\StringTok{\textquotesingle{}/Stan/EXNEX.stan\textquotesingle{}}\NormalTok{))}
\NormalTok{DPMEX\_stan   }\OtherTok{\textless{}{-}} \FunctionTok{cmdstan\_model}\NormalTok{(}\FunctionTok{paste0}\NormalTok{(}\FunctionTok{getwd}\NormalTok{(), }\StringTok{\textquotesingle{}/Stan/DPMEX.stan\textquotesingle{}}\NormalTok{))}
\NormalTok{DMPP\_stan    }\OtherTok{\textless{}{-}} \FunctionTok{cmdstan\_model}\NormalTok{(}\FunctionTok{paste0}\NormalTok{(}\FunctionTok{getwd}\NormalTok{(), }\StringTok{\textquotesingle{}/Stan/DMPP.stan\textquotesingle{}}\NormalTok{))}
\NormalTok{UIPDir\_stan  }\OtherTok{\textless{}{-}} \FunctionTok{cmdstan\_model}\NormalTok{(}\FunctionTok{paste0}\NormalTok{(}\FunctionTok{getwd}\NormalTok{(), }\StringTok{\textquotesingle{}/Stan/UIPDir.stan\textquotesingle{}}\NormalTok{))}
\NormalTok{HS\_stan      }\OtherTok{\textless{}{-}} \FunctionTok{cmdstan\_model}\NormalTok{(}\FunctionTok{paste0}\NormalTok{(}\FunctionTok{getwd}\NormalTok{(), }\StringTok{\textquotesingle{}/Stan/HS.stan\textquotesingle{}}\NormalTok{))}
\NormalTok{DL\_stan      }\OtherTok{\textless{}{-}} \FunctionTok{cmdstan\_model}\NormalTok{(}\FunctionTok{paste0}\NormalTok{(}\FunctionTok{getwd}\NormalTok{(), }\StringTok{\textquotesingle{}/Stan/DL.stan\textquotesingle{}}\NormalTok{))}
\NormalTok{SS\_stan      }\OtherTok{\textless{}{-}} \FunctionTok{cmdstan\_model}\NormalTok{(}\FunctionTok{paste0}\NormalTok{(}\FunctionTok{getwd}\NormalTok{(), }\StringTok{\textquotesingle{}/Stan/SS.stan\textquotesingle{}}\NormalTok{))}
\NormalTok{SSL\_stan     }\OtherTok{\textless{}{-}} \FunctionTok{cmdstan\_model}\NormalTok{(}\FunctionTok{paste0}\NormalTok{(}\FunctionTok{getwd}\NormalTok{(), }\StringTok{\textquotesingle{}/Stan/SSL.stan\textquotesingle{}}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\hypertarget{create-r-function-for-calculating-effective-sample-size-and-drawing-posterior-distributions-for-beta_rm-h_k}{%
\subsection{\texorpdfstring{Create R function for calculating effective
sample size and drawing posterior distributions for
\(\beta_{{\rm H}_k}\)}{Create R function for calculating effective sample size and drawing posterior distributions for \textbackslash beta\_\{\{\textbackslash rm H\}\_k\}}}\label{create-r-function-for-calculating-effective-sample-size-and-drawing-posterior-distributions-for-beta_rm-h_k}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{ess\_calc3 }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(fit)\{}
\NormalTok{  mix }\OtherTok{\textless{}{-}} \FunctionTok{mixfit}\NormalTok{(fit}\SpecialCharTok{$}\FunctionTok{draws}\NormalTok{(}\StringTok{"pi\_C"}\NormalTok{), }\AttributeTok{type =} \StringTok{"beta"}\NormalTok{, }
                \AttributeTok{Nc =} \DecValTok{3}\NormalTok{, }\AttributeTok{constrain\_gt1 =}\ConstantTok{TRUE}\NormalTok{, }\AttributeTok{eps =} \FloatTok{0.01}\NormalTok{)}
\NormalTok{  ESS }\OtherTok{\textless{}{-}} \FunctionTok{ess}\NormalTok{(mix)}
  \FunctionTok{return}\NormalTok{(ESS)}
\NormalTok{\}}


\NormalTok{beta\_fig }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(fit, titlevar)\{}
\NormalTok{  result\_fit }\OtherTok{\textless{}{-}}\NormalTok{ fit}\SpecialCharTok{$}\FunctionTok{output\_files}\NormalTok{() }\SpecialCharTok{\%\textgreater{}\%}\NormalTok{ rstan}\SpecialCharTok{::}\FunctionTok{read\_stan\_csv}\NormalTok{()}
\NormalTok{  plot100 }\OtherTok{\textless{}{-}} \FunctionTok{stan\_dens}\NormalTok{(result\_fit, }\AttributeTok{pars =} \FunctionTok{c}\NormalTok{(}\StringTok{"beta"}\NormalTok{))}\SpecialCharTok{$}\NormalTok{data}
\NormalTok{  plot100\_ }\OtherTok{\textless{}{-}}\NormalTok{ plot100[}\FunctionTok{order}\NormalTok{(plot100}\SpecialCharTok{$}\NormalTok{parameter, plot100}\SpecialCharTok{$}\NormalTok{chain),]}
\NormalTok{  plot100\_1 }\OtherTok{\textless{}{-}}\NormalTok{ plot100\_ }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{filter}\NormalTok{(parameter }\SpecialCharTok{\%in\%}
      \FunctionTok{c}\NormalTok{(}\StringTok{"beta[1]"}\NormalTok{, }\StringTok{"beta[2]"}\NormalTok{, }\StringTok{"beta[3]"}\NormalTok{, }\StringTok{"beta[4]"}\NormalTok{, }\StringTok{"beta[5]"}\NormalTok{,}
        \StringTok{"beta[6]"}\NormalTok{, }\StringTok{"beta[7]"}\NormalTok{, }\StringTok{"beta[8]"}\NormalTok{ )) }\SpecialCharTok{\%\textgreater{}\%} 
    \FunctionTok{mutate}\NormalTok{(}\AttributeTok{color =} \FunctionTok{case\_when}\NormalTok{(}
\NormalTok{      parameter }\SpecialCharTok{==} \StringTok{"beta[1]"} \SpecialCharTok{\textasciitilde{}} \StringTok{"beta1"}\NormalTok{,}
\NormalTok{      parameter }\SpecialCharTok{==} \StringTok{"beta[2]"} \SpecialCharTok{\textasciitilde{}} \StringTok{"beta2"}\NormalTok{,}
\NormalTok{      parameter }\SpecialCharTok{==} \StringTok{"beta[3]"} \SpecialCharTok{\textasciitilde{}} \StringTok{"beta3"}\NormalTok{,}
\NormalTok{      parameter }\SpecialCharTok{==} \StringTok{"beta[4]"} \SpecialCharTok{\textasciitilde{}} \StringTok{"beta4"}\NormalTok{,}
\NormalTok{      parameter }\SpecialCharTok{==} \StringTok{"beta[5]"} \SpecialCharTok{\textasciitilde{}} \StringTok{"beta5"}\NormalTok{,}
\NormalTok{      parameter }\SpecialCharTok{==} \StringTok{"beta[6]"} \SpecialCharTok{\textasciitilde{}} \StringTok{"beta6"}\NormalTok{,}
\NormalTok{      parameter }\SpecialCharTok{==} \StringTok{"beta[7]"} \SpecialCharTok{\textasciitilde{}} \StringTok{"beta7"}\NormalTok{,}
\NormalTok{      parameter }\SpecialCharTok{==} \StringTok{"beta[8]"} \SpecialCharTok{\textasciitilde{}} \StringTok{"beta8"}\NormalTok{,}
      \ConstantTok{TRUE} \SpecialCharTok{\textasciitilde{}} \StringTok{" "}
\NormalTok{    )}
\NormalTok{    )}
  
\NormalTok{  out }\OtherTok{\textless{}{-}} \FunctionTok{ggplot}\NormalTok{(}\AttributeTok{data =}\NormalTok{ plot100\_1, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ value, }\AttributeTok{color =}\NormalTok{ color)) }\SpecialCharTok{+}
    \FunctionTok{labs}\NormalTok{(}\AttributeTok{title =}\NormalTok{ titlevar) }\SpecialCharTok{+} 
    \FunctionTok{stat\_density}\NormalTok{(}\AttributeTok{geom =} \StringTok{"line"}\NormalTok{, }\AttributeTok{position =} \StringTok{"identity"}\NormalTok{, }\AttributeTok{size =} \DecValTok{12}\NormalTok{) }\SpecialCharTok{+}
    \FunctionTok{scale\_colour\_manual}\NormalTok{(}
      \StringTok{"beta"}\NormalTok{,}
      \AttributeTok{values =} \FunctionTok{c}\NormalTok{(}\StringTok{"\#03A9F4"}\NormalTok{, }\StringTok{"\#1976D2"}\NormalTok{, }\StringTok{"\#4E944F"}\NormalTok{, }\StringTok{"\#125B50"}\NormalTok{,}
                 \StringTok{"\#D4D925"}\NormalTok{, }\StringTok{"\#E8630A"}\NormalTok{, }\StringTok{"\#FF0099"}\NormalTok{, }\StringTok{"\#9900F0"}\NormalTok{),}
      \AttributeTok{labels =} \FunctionTok{c}\NormalTok{(}\FunctionTok{expression}\NormalTok{(beta[}\DecValTok{1}\NormalTok{]), }\FunctionTok{expression}\NormalTok{(beta[}\DecValTok{2}\NormalTok{]), }
                 \FunctionTok{expression}\NormalTok{(beta[}\DecValTok{3}\NormalTok{]), }\FunctionTok{expression}\NormalTok{(beta[}\DecValTok{4}\NormalTok{]), }
                 \FunctionTok{expression}\NormalTok{(beta[}\DecValTok{5}\NormalTok{]), }\FunctionTok{expression}\NormalTok{(beta[}\DecValTok{6}\NormalTok{]), }
                 \FunctionTok{expression}\NormalTok{(beta[}\DecValTok{7}\NormalTok{]), }\FunctionTok{expression}\NormalTok{(beta[}\DecValTok{8}\NormalTok{]))}
\NormalTok{    ) }\SpecialCharTok{+}
    \FunctionTok{xlab}\NormalTok{(}\FunctionTok{expression}\NormalTok{(beta)) }\SpecialCharTok{+}
    \FunctionTok{ylab}\NormalTok{(}\StringTok{"Density"}\NormalTok{) }\SpecialCharTok{+}
    \FunctionTok{scale\_x\_continuous}\NormalTok{(}\AttributeTok{breaks =} \FunctionTok{seq}\NormalTok{(}\SpecialCharTok{{-}}\DecValTok{2}\NormalTok{, }\DecValTok{4}\NormalTok{, }\AttributeTok{by =} \DecValTok{2}\NormalTok{), }\AttributeTok{limits =} \FunctionTok{c}\NormalTok{(}\SpecialCharTok{{-}}\DecValTok{2}\NormalTok{, }\DecValTok{4}\NormalTok{)) }\SpecialCharTok{+} 
    \FunctionTok{scale\_y\_continuous}\NormalTok{(}\AttributeTok{breaks =} \FunctionTok{seq}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{2}\NormalTok{, }\AttributeTok{by =} \DecValTok{1}\NormalTok{), }\AttributeTok{limits =} \FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{, }\FloatTok{2.5}\NormalTok{)) }\SpecialCharTok{+} 
    \FunctionTok{theme}\NormalTok{(}
      \AttributeTok{plot.title =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{size =} \DecValTok{240}\NormalTok{),}
      \AttributeTok{axis.text =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{colour =} \StringTok{"black"}\NormalTok{, }\AttributeTok{size =} \DecValTok{240}\NormalTok{),}
      \AttributeTok{axis.ticks=}\FunctionTok{element\_line}\NormalTok{(}\AttributeTok{colour =} \StringTok{"black"}\NormalTok{, }\AttributeTok{size =} \DecValTok{1}\NormalTok{),}
      \AttributeTok{axis.title.x =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{size =} \DecValTok{240}\NormalTok{),}
      \AttributeTok{axis.title.y =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{size =} \DecValTok{240}\NormalTok{),}
      \AttributeTok{axis.line =} \FunctionTok{element\_line}\NormalTok{(}\AttributeTok{colour =} \StringTok{"\#000000"}\NormalTok{, }
                    \AttributeTok{size =} \DecValTok{10}\NormalTok{, }\AttributeTok{linetype =} \StringTok{"solid"}\NormalTok{, }\AttributeTok{lineend =} \StringTok{"round"}\NormalTok{),}
      \AttributeTok{panel.background =} \FunctionTok{element\_rect}\NormalTok{(}\AttributeTok{fill =} \StringTok{"transparent"}\NormalTok{, }\AttributeTok{colour =} \ConstantTok{NA}\NormalTok{),}
      \AttributeTok{panel.border =} \FunctionTok{element\_blank}\NormalTok{(),}
      \AttributeTok{panel.grid =} \FunctionTok{element\_blank}\NormalTok{(),}
      \AttributeTok{panel.grid.major =} \FunctionTok{element\_blank}\NormalTok{(),}
      \AttributeTok{panel.grid.minor =} \FunctionTok{element\_blank}\NormalTok{(),}
      \AttributeTok{panel.grid.major.x =} \FunctionTok{element\_blank}\NormalTok{(),}
      \AttributeTok{panel.grid.major.y =} \FunctionTok{element\_blank}\NormalTok{(),}
      \AttributeTok{panel.grid.minor.x =} \FunctionTok{element\_blank}\NormalTok{(),}
      \AttributeTok{panel.grid.minor.y =} \FunctionTok{element\_blank}\NormalTok{(),}
      \AttributeTok{legend.title =} \FunctionTok{element\_blank}\NormalTok{(),}
      \AttributeTok{legend.text =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{size =} \DecValTok{240}\NormalTok{),}
      \AttributeTok{legend.key =} \FunctionTok{element\_rect}\NormalTok{(}\AttributeTok{fill =} \StringTok{"transparent"}\NormalTok{, }\AttributeTok{colour =} \ConstantTok{NA}\NormalTok{),}
      \AttributeTok{legend.key.width =} \FunctionTok{unit}\NormalTok{(}\DecValTok{20}\NormalTok{, }\StringTok{"cm"}\NormalTok{),}
      \AttributeTok{legend.position =} \FunctionTok{c}\NormalTok{(}\FloatTok{0.8}\NormalTok{, }\FloatTok{0.5}\NormalTok{),}
      \AttributeTok{legend.key.size =} \FunctionTok{unit}\NormalTok{(}\DecValTok{2}\NormalTok{, }\StringTok{\textquotesingle{}lines\textquotesingle{}}\NormalTok{),}
      \AttributeTok{legend.spacing.x =} \FunctionTok{unit}\NormalTok{(}\DecValTok{10}\NormalTok{, }\StringTok{\textquotesingle{}cm\textquotesingle{}}\NormalTok{)}
\NormalTok{    )}
  \FunctionTok{return}\NormalTok{(out)}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\hypertarget{case-study-1-original-data}{%
\section{Case study 1 (original
data)}\label{case-study-1-original-data}}

\hypertarget{datasets}{%
\subsection{Datasets}\label{datasets}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{n\_h }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{107}\NormalTok{, }\DecValTok{44}\NormalTok{, }\DecValTok{51}\NormalTok{, }\DecValTok{39}\NormalTok{, }\DecValTok{139}\NormalTok{, }\DecValTok{20}\NormalTok{, }\DecValTok{78}\NormalTok{, }\DecValTok{35}\NormalTok{)}
\NormalTok{x\_h }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{( }\DecValTok{23}\NormalTok{, }\DecValTok{12}\NormalTok{, }\DecValTok{19}\NormalTok{,  }\DecValTok{9}\NormalTok{,  }\DecValTok{39}\NormalTok{,  }\DecValTok{6}\NormalTok{,  }\DecValTok{9}\NormalTok{, }\DecValTok{10}\NormalTok{)}
\NormalTok{n\_CC }\OtherTok{\textless{}{-}} \DecValTok{6}
\NormalTok{x\_CC }\OtherTok{\textless{}{-}} \DecValTok{1}
\NormalTok{n\_CT }\OtherTok{\textless{}{-}} \DecValTok{23}
\NormalTok{x\_CT }\OtherTok{\textless{}{-}} \DecValTok{14}

\NormalTok{Historical }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}
  \AttributeTok{N =}\NormalTok{ n\_h, }
  \AttributeTok{X =}\NormalTok{ x\_h}
\NormalTok{)}

\NormalTok{Current }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}
  \AttributeTok{TRT =} \FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{),}
  \AttributeTok{N =} \FunctionTok{c}\NormalTok{(n\_CC, n\_CT),}
  \AttributeTok{X =} \FunctionTok{c}\NormalTok{(x\_CC, x\_CT)}
\NormalTok{)}

\NormalTok{Data\_all }\OtherTok{\textless{}{-}} \FunctionTok{list}\NormalTok{(}\AttributeTok{Historical =}\NormalTok{ Historical, }\AttributeTok{Current =}\NormalTok{ Current)}
\NormalTok{ANA }\OtherTok{\textless{}{-}} \FunctionTok{list}\NormalTok{(}\AttributeTok{H =} \FunctionTok{length}\NormalTok{(Data\_all}\SpecialCharTok{$}\NormalTok{Historical[,}\StringTok{"N"}\NormalTok{]),}
            \AttributeTok{x\_h =}\NormalTok{ Data\_all}\SpecialCharTok{$}\NormalTok{Historical[,}\StringTok{"X"}\NormalTok{], }\AttributeTok{n\_h =}\NormalTok{ Data\_all}\SpecialCharTok{$}\NormalTok{Historical[,}\StringTok{"N"}\NormalTok{],}
            \AttributeTok{x\_CC =}\NormalTok{ Data\_all}\SpecialCharTok{$}\NormalTok{Current}\SpecialCharTok{$}\NormalTok{X[}\DecValTok{1}\NormalTok{], }\AttributeTok{n\_CC =}\NormalTok{ Data\_all}\SpecialCharTok{$}\NormalTok{Current}\SpecialCharTok{$}\NormalTok{N[}\DecValTok{1}\NormalTok{],}
            \AttributeTok{x\_CT =}\NormalTok{ Data\_all}\SpecialCharTok{$}\NormalTok{Current}\SpecialCharTok{$}\NormalTok{X[}\DecValTok{2}\NormalTok{], }\AttributeTok{n\_CT =}\NormalTok{ Data\_all}\SpecialCharTok{$}\NormalTok{Current}\SpecialCharTok{$}\NormalTok{N[}\DecValTok{2}\NormalTok{], }
            \AttributeTok{betascale =} \DecValTok{1}\NormalTok{, }\AttributeTok{nu =} \DecValTok{1}\NormalTok{, }\AttributeTok{C =} \DecValTok{10}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\hypertarget{mcmc-fitting}{%
\subsection{MCMC fitting}\label{mcmc-fitting}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{fit\_Current  }\OtherTok{\textless{}{-}}\NormalTok{ Current\_stan}\SpecialCharTok{$}\FunctionTok{sample}\NormalTok{(}\AttributeTok{data =}\NormalTok{ ANA, }\AttributeTok{seed =} \DecValTok{999}\NormalTok{, }\AttributeTok{chains =} \DecValTok{4}\NormalTok{, }
        \AttributeTok{parallel\_chains =} \DecValTok{4}\NormalTok{, }\AttributeTok{iter\_warmup =} \DecValTok{4000}\NormalTok{, }\AttributeTok{iter\_sampling =} \DecValTok{4000}\NormalTok{, }\AttributeTok{refresh =} \DecValTok{0}\NormalTok{)}

\NormalTok{fit\_Pooled }\OtherTok{\textless{}{-}}\NormalTok{ Pooled\_stan}\SpecialCharTok{$}\FunctionTok{sample}\NormalTok{(}\AttributeTok{data =}\NormalTok{ ANA, }\AttributeTok{seed =} \DecValTok{999}\NormalTok{, }\AttributeTok{chains =} \DecValTok{4}\NormalTok{, }
        \AttributeTok{parallel\_chains =} \DecValTok{4}\NormalTok{, }\AttributeTok{iter\_warmup =} \DecValTok{4000}\NormalTok{, }\AttributeTok{iter\_sampling =} \DecValTok{4000}\NormalTok{, }\AttributeTok{refresh =} \DecValTok{0}\NormalTok{)}

\NormalTok{fit\_EX     }\OtherTok{\textless{}{-}}\NormalTok{ EX\_stan}\SpecialCharTok{$}\FunctionTok{sample}\NormalTok{(}\AttributeTok{data =}\NormalTok{ ANA, }\AttributeTok{seed =} \DecValTok{999}\NormalTok{, }\AttributeTok{chains =} \DecValTok{4}\NormalTok{, }
        \AttributeTok{parallel\_chains =} \DecValTok{4}\NormalTok{, }\AttributeTok{iter\_warmup =} \DecValTok{4000}\NormalTok{, }\AttributeTok{iter\_sampling =} \DecValTok{4000}\NormalTok{, }
        \AttributeTok{adapt\_delta =} \FloatTok{0.9}\NormalTok{, }\AttributeTok{refresh =} \DecValTok{0}\NormalTok{)}

\NormalTok{fit\_EXNEX  }\OtherTok{\textless{}{-}}\NormalTok{ EXNEX\_stan}\SpecialCharTok{$}\FunctionTok{sample}\NormalTok{(}\AttributeTok{data =}\NormalTok{ ANA, }\AttributeTok{seed =} \DecValTok{999}\NormalTok{, }\AttributeTok{chains =} \DecValTok{4}\NormalTok{, }
        \AttributeTok{parallel\_chains =} \DecValTok{4}\NormalTok{, }\AttributeTok{iter\_warmup =} \DecValTok{4000}\NormalTok{, }\AttributeTok{iter\_sampling =} \DecValTok{4000}\NormalTok{, }
        \AttributeTok{adapt\_delta =} \FloatTok{0.9}\NormalTok{, }\AttributeTok{refresh =} \DecValTok{0}\NormalTok{)}

\NormalTok{fit\_DPMEX  }\OtherTok{\textless{}{-}}\NormalTok{ DPMEX\_stan}\SpecialCharTok{$}\FunctionTok{sample}\NormalTok{(}\AttributeTok{data =}\NormalTok{ ANA, }\AttributeTok{seed =} \DecValTok{999}\NormalTok{, }\AttributeTok{chains =} \DecValTok{4}\NormalTok{, }
        \AttributeTok{parallel\_chains =} \DecValTok{4}\NormalTok{, }\AttributeTok{iter\_warmup =} \DecValTok{4000}\NormalTok{, }\AttributeTok{iter\_sampling =} \DecValTok{6000}\NormalTok{, }
        \AttributeTok{adapt\_delta =} \FloatTok{0.95}\NormalTok{, }\AttributeTok{refresh =} \DecValTok{0}\NormalTok{)}

\NormalTok{fit\_DMPP   }\OtherTok{\textless{}{-}}\NormalTok{ DMPP\_stan}\SpecialCharTok{$}\FunctionTok{sample}\NormalTok{(}\AttributeTok{data =}\NormalTok{ ANA, }\AttributeTok{seed =} \DecValTok{999}\NormalTok{, }\AttributeTok{chains =} \DecValTok{4}\NormalTok{, }
        \AttributeTok{parallel\_chains =} \DecValTok{4}\NormalTok{, }\AttributeTok{iter\_warmup =} \DecValTok{4000}\NormalTok{, }\AttributeTok{iter\_sampling =} \DecValTok{6000}\NormalTok{, }
        \AttributeTok{adapt\_delta =} \FloatTok{0.95}\NormalTok{, }\AttributeTok{refresh =} \DecValTok{0}\NormalTok{)}

\NormalTok{gamma\_h }\OtherTok{=} \FunctionTok{rep}\NormalTok{(}\ConstantTok{NA}\NormalTok{, }\FunctionTok{length}\NormalTok{(Data\_all}\SpecialCharTok{$}\NormalTok{Historical[,}\StringTok{"N"}\NormalTok{]))}
\ControlFlowTok{for}\NormalTok{(h }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\FunctionTok{length}\NormalTok{(Data\_all}\SpecialCharTok{$}\NormalTok{Historical[,}\StringTok{"N"}\NormalTok{]))\{}
\NormalTok{  gamma\_h[h] }\OtherTok{=} \FunctionTok{min}\NormalTok{(}\DecValTok{1}\NormalTok{, Data\_all}\SpecialCharTok{$}\NormalTok{Historical[,}\StringTok{"N"}\NormalTok{][h] }\SpecialCharTok{/}\NormalTok{ Data\_all}\SpecialCharTok{$}\NormalTok{Current}\SpecialCharTok{$}\NormalTok{N[}\DecValTok{1}\NormalTok{])}
\NormalTok{\}}

\NormalTok{theta\_h }\OtherTok{\textless{}{-}} \FunctionTok{rep}\NormalTok{(}\ConstantTok{NA}\NormalTok{, }\FunctionTok{length}\NormalTok{(n\_h))}
\NormalTok{I\_U }\OtherTok{\textless{}{-}} \FunctionTok{rep}\NormalTok{(}\ConstantTok{NA}\NormalTok{, }\FunctionTok{length}\NormalTok{(n\_h))}
\ControlFlowTok{for}\NormalTok{(h }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\FunctionTok{length}\NormalTok{(n\_h))\{}
\NormalTok{  theta\_h[h] }\OtherTok{=}\NormalTok{ x\_h[h] }\SpecialCharTok{*} \FloatTok{1.0} \SpecialCharTok{/}\NormalTok{ n\_h[h]}
\NormalTok{  I\_U[h] }\OtherTok{=} \DecValTok{1} \SpecialCharTok{/}\NormalTok{ (theta\_h[h] }\SpecialCharTok{*}\NormalTok{ (}\DecValTok{1} \SpecialCharTok{{-}}\NormalTok{ theta\_h[h]))}
\NormalTok{\}}

\NormalTok{ANA\_UIP }\OtherTok{\textless{}{-}} \FunctionTok{list}\NormalTok{(}\AttributeTok{H =} \FunctionTok{length}\NormalTok{(Data\_all}\SpecialCharTok{$}\NormalTok{Historical[,}\StringTok{"N"}\NormalTok{]),}
                \AttributeTok{x\_h =}\NormalTok{ Data\_all}\SpecialCharTok{$}\NormalTok{Historical}\SpecialCharTok{$}\NormalTok{X, }\AttributeTok{n\_h =}\NormalTok{ Data\_all}\SpecialCharTok{$}\NormalTok{Historical}\SpecialCharTok{$}\NormalTok{N, }
                \AttributeTok{x\_CC =}\NormalTok{ Data\_all}\SpecialCharTok{$}\NormalTok{Current}\SpecialCharTok{$}\NormalTok{X[}\DecValTok{1}\NormalTok{], }\AttributeTok{n\_CC =}\NormalTok{ Data\_all}\SpecialCharTok{$}\NormalTok{Current}\SpecialCharTok{$}\NormalTok{N[}\DecValTok{1}\NormalTok{], }
                \AttributeTok{x\_CT =}\NormalTok{ Data\_all}\SpecialCharTok{$}\NormalTok{Current}\SpecialCharTok{$}\NormalTok{X[}\DecValTok{2}\NormalTok{], }\AttributeTok{n\_CT =}\NormalTok{ Data\_all}\SpecialCharTok{$}\NormalTok{Current}\SpecialCharTok{$}\NormalTok{N[}\DecValTok{2}\NormalTok{], }
                \AttributeTok{gamma\_h =}\NormalTok{ gamma\_h, }\AttributeTok{theta\_h =}\NormalTok{ theta\_h, }\AttributeTok{I\_U =}\NormalTok{ I\_U)}

\NormalTok{fit\_UIPDir  }\OtherTok{\textless{}{-}}\NormalTok{ UIPDir\_stan}\SpecialCharTok{$}\FunctionTok{sample}\NormalTok{(}\AttributeTok{data =}\NormalTok{ ANA\_UIP, }\AttributeTok{seed =} \DecValTok{999}\NormalTok{, }\AttributeTok{chains =} \DecValTok{4}\NormalTok{, }
        \AttributeTok{parallel\_chains =} \DecValTok{4}\NormalTok{, }\AttributeTok{iter\_warmup =} \DecValTok{4000}\NormalTok{, }\AttributeTok{iter\_sampling =} \DecValTok{8000}\NormalTok{, }
        \AttributeTok{adapt\_delta =} \FloatTok{0.999}\NormalTok{, }\AttributeTok{max\_treedepth =} \DecValTok{12}\NormalTok{, }\AttributeTok{refresh =} \DecValTok{0}\NormalTok{)}


\NormalTok{fit\_HS     }\OtherTok{\textless{}{-}}\NormalTok{ HS\_stan}\SpecialCharTok{$}\FunctionTok{sample}\NormalTok{(}\AttributeTok{data =}\NormalTok{ ANA, }\AttributeTok{seed =} \DecValTok{999}\NormalTok{, }\AttributeTok{chains =} \DecValTok{4}\NormalTok{, }
        \AttributeTok{parallel\_chains =} \DecValTok{4}\NormalTok{, }\AttributeTok{iter\_warmup =} \DecValTok{4000}\NormalTok{, }\AttributeTok{iter\_sampling =} \DecValTok{12000}\NormalTok{, }
        \AttributeTok{adapt\_delta =} \FloatTok{0.999}\NormalTok{, }\AttributeTok{refresh =} \DecValTok{0}\NormalTok{)}

\NormalTok{ANA\_DL }\OtherTok{\textless{}{-}} \FunctionTok{list}\NormalTok{(}\AttributeTok{H =} \FunctionTok{length}\NormalTok{(Data\_all}\SpecialCharTok{$}\NormalTok{Historical[,}\StringTok{"N"}\NormalTok{]),}
               \AttributeTok{x\_h =}\NormalTok{ Data\_all}\SpecialCharTok{$}\NormalTok{Historical[,}\StringTok{"X"}\NormalTok{], }\AttributeTok{n\_h =}\NormalTok{ Data\_all}\SpecialCharTok{$}\NormalTok{Historical[,}\StringTok{"N"}\NormalTok{], }
               \AttributeTok{x\_CC =}\NormalTok{ Data\_all}\SpecialCharTok{$}\NormalTok{Current}\SpecialCharTok{$}\NormalTok{X[}\DecValTok{1}\NormalTok{], }\AttributeTok{n\_CC =}\NormalTok{ Data\_all}\SpecialCharTok{$}\NormalTok{Current}\SpecialCharTok{$}\NormalTok{N[}\DecValTok{1}\NormalTok{], }
               \AttributeTok{x\_CT =}\NormalTok{ Data\_all}\SpecialCharTok{$}\NormalTok{Current}\SpecialCharTok{$}\NormalTok{X[}\DecValTok{2}\NormalTok{], }\AttributeTok{n\_CT =}\NormalTok{ Data\_all}\SpecialCharTok{$}\NormalTok{Current}\SpecialCharTok{$}\NormalTok{N[}\DecValTok{2}\NormalTok{], }\AttributeTok{a =} \FloatTok{0.5}\NormalTok{)}

\NormalTok{fit\_DL }\OtherTok{\textless{}{-}}\NormalTok{ DL\_stan}\SpecialCharTok{$}\FunctionTok{sample}\NormalTok{(}\AttributeTok{data =}\NormalTok{ ANA\_DL, }\AttributeTok{seed =} \DecValTok{999}\NormalTok{, }\AttributeTok{chains =} \DecValTok{4}\NormalTok{, }
        \AttributeTok{parallel\_chains =} \DecValTok{4}\NormalTok{, }\AttributeTok{iter\_warmup =} \DecValTok{4000}\NormalTok{, }\AttributeTok{iter\_sampling =} \DecValTok{4000}\NormalTok{, }
        \AttributeTok{adapt\_delta =} \FloatTok{0.9}\NormalTok{, }\AttributeTok{refresh =} \DecValTok{0}\NormalTok{)}

\NormalTok{fit\_SS     }\OtherTok{\textless{}{-}}\NormalTok{ SS\_stan}\SpecialCharTok{$}\FunctionTok{sample}\NormalTok{(}\AttributeTok{data =}\NormalTok{ ANA, }\AttributeTok{seed =} \DecValTok{999}\NormalTok{, }\AttributeTok{chains =} \DecValTok{4}\NormalTok{, }
        \AttributeTok{parallel\_chains =} \DecValTok{4}\NormalTok{, }\AttributeTok{iter\_warmup =} \DecValTok{4000}\NormalTok{, }\AttributeTok{iter\_sampling =} \DecValTok{6000}\NormalTok{, }
        \AttributeTok{adapt\_delta =} \FloatTok{0.95}\NormalTok{, }\AttributeTok{max\_treedepth =} \DecValTok{12}\NormalTok{, }\AttributeTok{refresh =} \DecValTok{0}\NormalTok{)}

\NormalTok{ANA\_SSL }\OtherTok{\textless{}{-}} \FunctionTok{list}\NormalTok{(}\AttributeTok{H =} \FunctionTok{length}\NormalTok{(Data\_all}\SpecialCharTok{$}\NormalTok{Historical[,}\StringTok{"N"}\NormalTok{]), }
                \AttributeTok{x\_h =}\NormalTok{ Data\_all}\SpecialCharTok{$}\NormalTok{Historical[,}\StringTok{"X"}\NormalTok{], }\AttributeTok{n\_h =}\NormalTok{ Data\_all}\SpecialCharTok{$}\NormalTok{Historical[,}\StringTok{"N"}\NormalTok{], }
                \AttributeTok{x\_CC =}\NormalTok{ Data\_all}\SpecialCharTok{$}\NormalTok{Current}\SpecialCharTok{$}\NormalTok{X[}\DecValTok{1}\NormalTok{], }\AttributeTok{n\_CC =}\NormalTok{ Data\_all}\SpecialCharTok{$}\NormalTok{Current}\SpecialCharTok{$}\NormalTok{N[}\DecValTok{1}\NormalTok{], }
                \AttributeTok{x\_CT  =}\NormalTok{Data\_all}\SpecialCharTok{$}\NormalTok{Current}\SpecialCharTok{$}\NormalTok{X[}\DecValTok{2}\NormalTok{], }\AttributeTok{n\_CT =}\NormalTok{ Data\_all}\SpecialCharTok{$}\NormalTok{Current}\SpecialCharTok{$}\NormalTok{N[}\DecValTok{2}\NormalTok{], }
                \AttributeTok{lambda\_spike =} \FloatTok{0.1}\NormalTok{, }\AttributeTok{lambda\_slab =} \FloatTok{2.0}\NormalTok{)}

\NormalTok{fit\_SSL }\OtherTok{\textless{}{-}}\NormalTok{ SSL\_stan}\SpecialCharTok{$}\FunctionTok{sample}\NormalTok{(}\AttributeTok{data =}\NormalTok{ ANA\_SSL, }\AttributeTok{seed =} \DecValTok{999}\NormalTok{, }\AttributeTok{chains =} \DecValTok{4}\NormalTok{, }
        \AttributeTok{parallel\_chains =} \DecValTok{4}\NormalTok{, }\AttributeTok{iter\_warmup =} \DecValTok{4000}\NormalTok{, }\AttributeTok{iter\_sampling =} \DecValTok{4000}\NormalTok{, }
        \AttributeTok{adapt\_delta =} \FloatTok{0.9}\NormalTok{, }\AttributeTok{refresh =} \DecValTok{0}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\hypertarget{aggregate-posterior-distribution}{%
\subsection{Aggregate posterior
distribution}\label{aggregate-posterior-distribution}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{Result\_ALL }\OtherTok{\textless{}{-}} \FunctionTok{matrix}\NormalTok{(}\DecValTok{0}\NormalTok{, }\AttributeTok{nrow =} \DecValTok{11}\NormalTok{, }\AttributeTok{ncol =} \DecValTok{7}\NormalTok{)}
\NormalTok{Result\_ALL[}\DecValTok{1}\NormalTok{,]  }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\FunctionTok{mean}\NormalTok{(fit\_Current}\SpecialCharTok{$}\FunctionTok{draws}\NormalTok{(}\StringTok{"g\_pi"}\NormalTok{)), }\FunctionTok{sd}\NormalTok{(fit\_Current}\SpecialCharTok{$}\FunctionTok{draws}\NormalTok{(}\StringTok{"g\_pi"}\NormalTok{)),}
                     \FunctionTok{quantile}\NormalTok{(fit\_Current}\SpecialCharTok{$}\FunctionTok{draws}\NormalTok{(}\StringTok{"g\_pi"}\NormalTok{), }\FloatTok{0.025}\NormalTok{, }\AttributeTok{names =}\NormalTok{ F), }
                     \FunctionTok{quantile}\NormalTok{(fit\_Current}\SpecialCharTok{$}\FunctionTok{draws}\NormalTok{(}\StringTok{"g\_pi"}\NormalTok{), }\FloatTok{0.975}\NormalTok{, }\AttributeTok{names =}\NormalTok{ F), }
                     \FunctionTok{max}\NormalTok{(fit\_Current}\SpecialCharTok{$}\FunctionTok{summary}\NormalTok{()}\SpecialCharTok{$}\NormalTok{rhat), }\ConstantTok{NA}\NormalTok{)}
\NormalTok{Result\_ALL[}\DecValTok{2}\NormalTok{,]  }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{2}\NormalTok{, }\FunctionTok{mean}\NormalTok{(fit\_Pooled}\SpecialCharTok{$}\FunctionTok{draws}\NormalTok{(}\StringTok{"g\_pi"}\NormalTok{)), }\FunctionTok{sd}\NormalTok{(fit\_Pooled}\SpecialCharTok{$}\FunctionTok{draws}\NormalTok{(}\StringTok{"g\_pi"}\NormalTok{)), }
                     \FunctionTok{quantile}\NormalTok{(fit\_Pooled}\SpecialCharTok{$}\FunctionTok{draws}\NormalTok{(}\StringTok{"g\_pi"}\NormalTok{), }\FloatTok{0.025}\NormalTok{, }\AttributeTok{names =}\NormalTok{ F), }
                     \FunctionTok{quantile}\NormalTok{(fit\_Pooled}\SpecialCharTok{$}\FunctionTok{draws}\NormalTok{(}\StringTok{"g\_pi"}\NormalTok{), }\FloatTok{0.975}\NormalTok{, }\AttributeTok{names =}\NormalTok{ F), }
                     \FunctionTok{max}\NormalTok{(fit\_Pooled}\SpecialCharTok{$}\FunctionTok{summary}\NormalTok{()}\SpecialCharTok{$}\NormalTok{rhat), }\ConstantTok{NA}\NormalTok{)}
\NormalTok{Result\_ALL[}\DecValTok{3}\NormalTok{,]  }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{3}\NormalTok{, }\FunctionTok{mean}\NormalTok{(fit\_EX}\SpecialCharTok{$}\FunctionTok{draws}\NormalTok{(}\StringTok{"g\_pi"}\NormalTok{)), }\FunctionTok{sd}\NormalTok{(fit\_EX}\SpecialCharTok{$}\FunctionTok{draws}\NormalTok{(}\StringTok{"g\_pi"}\NormalTok{)), }
                     \FunctionTok{quantile}\NormalTok{(fit\_EX}\SpecialCharTok{$}\FunctionTok{draws}\NormalTok{(}\StringTok{"g\_pi"}\NormalTok{), }\FloatTok{0.025}\NormalTok{, }\AttributeTok{names =}\NormalTok{ F), }
                     \FunctionTok{quantile}\NormalTok{(fit\_EX}\SpecialCharTok{$}\FunctionTok{draws}\NormalTok{(}\StringTok{"g\_pi"}\NormalTok{), }\FloatTok{0.975}\NormalTok{, }\AttributeTok{names =}\NormalTok{ F), }
                     \FunctionTok{max}\NormalTok{(fit\_EX}\SpecialCharTok{$}\FunctionTok{summary}\NormalTok{()}\SpecialCharTok{$}\NormalTok{rhat), }\FunctionTok{ess\_calc3}\NormalTok{(fit\_EX))}
\NormalTok{Result\_ALL[}\DecValTok{4}\NormalTok{,]  }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{4}\NormalTok{, }\FunctionTok{mean}\NormalTok{(fit\_EXNEX}\SpecialCharTok{$}\FunctionTok{draws}\NormalTok{(}\StringTok{"g\_pi"}\NormalTok{)), }\FunctionTok{sd}\NormalTok{(fit\_EXNEX}\SpecialCharTok{$}\FunctionTok{draws}\NormalTok{(}\StringTok{"g\_pi"}\NormalTok{)), }
                     \FunctionTok{quantile}\NormalTok{(fit\_EXNEX}\SpecialCharTok{$}\FunctionTok{draws}\NormalTok{(}\StringTok{"g\_pi"}\NormalTok{), }\FloatTok{0.025}\NormalTok{, }\AttributeTok{names =}\NormalTok{ F), }
                     \FunctionTok{quantile}\NormalTok{(fit\_EXNEX}\SpecialCharTok{$}\FunctionTok{draws}\NormalTok{(}\StringTok{"g\_pi"}\NormalTok{), }\FloatTok{0.975}\NormalTok{, }\AttributeTok{names =}\NormalTok{ F), }
                     \FunctionTok{max}\NormalTok{(fit\_EXNEX}\SpecialCharTok{$}\FunctionTok{summary}\NormalTok{()}\SpecialCharTok{$}\NormalTok{rhat), }\FunctionTok{ess\_calc3}\NormalTok{(fit\_EXNEX))}
\NormalTok{Result\_ALL[}\DecValTok{5}\NormalTok{,]  }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{5}\NormalTok{, }\FunctionTok{mean}\NormalTok{(fit\_DPMEX}\SpecialCharTok{$}\FunctionTok{draws}\NormalTok{(}\StringTok{"g\_pi"}\NormalTok{)), }\FunctionTok{sd}\NormalTok{(fit\_DPMEX}\SpecialCharTok{$}\FunctionTok{draws}\NormalTok{(}\StringTok{"g\_pi"}\NormalTok{)), }
                     \FunctionTok{quantile}\NormalTok{(fit\_DPMEX}\SpecialCharTok{$}\FunctionTok{draws}\NormalTok{(}\StringTok{"g\_pi"}\NormalTok{), }\FloatTok{0.025}\NormalTok{, }\AttributeTok{names =}\NormalTok{ F), }
                     \FunctionTok{quantile}\NormalTok{(fit\_DPMEX}\SpecialCharTok{$}\FunctionTok{draws}\NormalTok{(}\StringTok{"g\_pi"}\NormalTok{), }\FloatTok{0.975}\NormalTok{, }\AttributeTok{names =}\NormalTok{ F), }
                     \FunctionTok{max}\NormalTok{(fit\_DPMEX}\SpecialCharTok{$}\FunctionTok{summary}\NormalTok{()}\SpecialCharTok{$}\NormalTok{rhat), }\FunctionTok{ess\_calc3}\NormalTok{(fit\_DPMEX))}
\NormalTok{Result\_ALL[}\DecValTok{6}\NormalTok{,]  }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{6}\NormalTok{, }\FunctionTok{mean}\NormalTok{(fit\_DMPP}\SpecialCharTok{$}\FunctionTok{draws}\NormalTok{(}\StringTok{"g\_pi"}\NormalTok{)), }\FunctionTok{sd}\NormalTok{(fit\_DMPP}\SpecialCharTok{$}\FunctionTok{draws}\NormalTok{(}\StringTok{"g\_pi"}\NormalTok{)), }
                     \FunctionTok{quantile}\NormalTok{(fit\_DMPP}\SpecialCharTok{$}\FunctionTok{draws}\NormalTok{(}\StringTok{"g\_pi"}\NormalTok{), }\FloatTok{0.025}\NormalTok{, }\AttributeTok{names =}\NormalTok{ F), }
                     \FunctionTok{quantile}\NormalTok{(fit\_DMPP}\SpecialCharTok{$}\FunctionTok{draws}\NormalTok{(}\StringTok{"g\_pi"}\NormalTok{), }\FloatTok{0.975}\NormalTok{, }\AttributeTok{names =}\NormalTok{ F), }
                     \FunctionTok{max}\NormalTok{(fit\_DMPP}\SpecialCharTok{$}\FunctionTok{summary}\NormalTok{()}\SpecialCharTok{$}\NormalTok{rhat), }\FunctionTok{ess\_calc3}\NormalTok{(fit\_DMPP))}
\NormalTok{Result\_ALL[}\DecValTok{7}\NormalTok{,]  }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{7}\NormalTok{, }\FunctionTok{mean}\NormalTok{(fit\_UIPDir}\SpecialCharTok{$}\FunctionTok{draws}\NormalTok{(}\StringTok{"g\_pi"}\NormalTok{)), }\FunctionTok{sd}\NormalTok{(fit\_UIPDir}\SpecialCharTok{$}\FunctionTok{draws}\NormalTok{(}\StringTok{"g\_pi"}\NormalTok{)), }
                     \FunctionTok{quantile}\NormalTok{(fit\_UIPDir}\SpecialCharTok{$}\FunctionTok{draws}\NormalTok{(}\StringTok{"g\_pi"}\NormalTok{), }\FloatTok{0.025}\NormalTok{, }\AttributeTok{names =}\NormalTok{ F), }
                     \FunctionTok{quantile}\NormalTok{(fit\_UIPDir}\SpecialCharTok{$}\FunctionTok{draws}\NormalTok{(}\StringTok{"g\_pi"}\NormalTok{), }\FloatTok{0.975}\NormalTok{, }\AttributeTok{names =}\NormalTok{ F), }
                     \FunctionTok{max}\NormalTok{(fit\_UIPDir}\SpecialCharTok{$}\FunctionTok{summary}\NormalTok{()}\SpecialCharTok{$}\NormalTok{rhat), }\FunctionTok{ess\_calc3}\NormalTok{(fit\_UIPDir))}
\NormalTok{Result\_ALL[}\DecValTok{8}\NormalTok{,]  }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{8}\NormalTok{, }\FunctionTok{mean}\NormalTok{(fit\_HS}\SpecialCharTok{$}\FunctionTok{draws}\NormalTok{(}\StringTok{"g\_pi"}\NormalTok{)), }\FunctionTok{sd}\NormalTok{(fit\_HS}\SpecialCharTok{$}\FunctionTok{draws}\NormalTok{(}\StringTok{"g\_pi"}\NormalTok{)), }
                     \FunctionTok{quantile}\NormalTok{(fit\_HS}\SpecialCharTok{$}\FunctionTok{draws}\NormalTok{(}\StringTok{"g\_pi"}\NormalTok{), }\FloatTok{0.025}\NormalTok{, }\AttributeTok{names =}\NormalTok{ F), }
                     \FunctionTok{quantile}\NormalTok{(fit\_HS}\SpecialCharTok{$}\FunctionTok{draws}\NormalTok{(}\StringTok{"g\_pi"}\NormalTok{), }\FloatTok{0.975}\NormalTok{, }\AttributeTok{names =}\NormalTok{ F), }
                     \FunctionTok{max}\NormalTok{(fit\_HS}\SpecialCharTok{$}\FunctionTok{summary}\NormalTok{()}\SpecialCharTok{$}\NormalTok{rhat) , }\FunctionTok{ess\_calc3}\NormalTok{(fit\_HS))}
\NormalTok{Result\_ALL[}\DecValTok{9}\NormalTok{,]  }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{9}\NormalTok{, }\FunctionTok{mean}\NormalTok{(fit\_DL}\SpecialCharTok{$}\FunctionTok{draws}\NormalTok{(}\StringTok{"g\_pi"}\NormalTok{)), }\FunctionTok{sd}\NormalTok{(fit\_DL}\SpecialCharTok{$}\FunctionTok{draws}\NormalTok{(}\StringTok{"g\_pi"}\NormalTok{)), }
                     \FunctionTok{quantile}\NormalTok{(fit\_DL}\SpecialCharTok{$}\FunctionTok{draws}\NormalTok{(}\StringTok{"g\_pi"}\NormalTok{), }\FloatTok{0.025}\NormalTok{, }\AttributeTok{names =}\NormalTok{ F), }
                     \FunctionTok{quantile}\NormalTok{(fit\_DL}\SpecialCharTok{$}\FunctionTok{draws}\NormalTok{(}\StringTok{"g\_pi"}\NormalTok{), }\FloatTok{0.975}\NormalTok{, }\AttributeTok{names =}\NormalTok{ F), }
                     \FunctionTok{max}\NormalTok{(fit\_DL}\SpecialCharTok{$}\FunctionTok{summary}\NormalTok{()}\SpecialCharTok{$}\NormalTok{rhat), }\FunctionTok{ess\_calc3}\NormalTok{(fit\_DL))}
\NormalTok{Result\_ALL[}\DecValTok{10}\NormalTok{,]  }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{10}\NormalTok{, }\FunctionTok{mean}\NormalTok{(fit\_SS}\SpecialCharTok{$}\FunctionTok{draws}\NormalTok{(}\StringTok{"g\_pi"}\NormalTok{)), }\FunctionTok{sd}\NormalTok{(fit\_SS}\SpecialCharTok{$}\FunctionTok{draws}\NormalTok{(}\StringTok{"g\_pi"}\NormalTok{)), }
                      \FunctionTok{quantile}\NormalTok{(fit\_SS}\SpecialCharTok{$}\FunctionTok{draws}\NormalTok{(}\StringTok{"g\_pi"}\NormalTok{), }\FloatTok{0.025}\NormalTok{, }\AttributeTok{names =}\NormalTok{ F), }
                      \FunctionTok{quantile}\NormalTok{(fit\_SS}\SpecialCharTok{$}\FunctionTok{draws}\NormalTok{(}\StringTok{"g\_pi"}\NormalTok{), }\FloatTok{0.975}\NormalTok{, }\AttributeTok{names =}\NormalTok{ F), }
                      \FunctionTok{max}\NormalTok{(fit\_SS}\SpecialCharTok{$}\FunctionTok{summary}\NormalTok{()}\SpecialCharTok{$}\NormalTok{rhat), }\FunctionTok{ess\_calc3}\NormalTok{(fit\_SS))}
\NormalTok{Result\_ALL[}\DecValTok{11}\NormalTok{,]  }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{11}\NormalTok{, }\FunctionTok{mean}\NormalTok{(fit\_SSL}\SpecialCharTok{$}\FunctionTok{draws}\NormalTok{(}\StringTok{"g\_pi"}\NormalTok{)), }\FunctionTok{sd}\NormalTok{(fit\_SSL}\SpecialCharTok{$}\FunctionTok{draws}\NormalTok{(}\StringTok{"g\_pi"}\NormalTok{)), }
                      \FunctionTok{quantile}\NormalTok{(fit\_SSL}\SpecialCharTok{$}\FunctionTok{draws}\NormalTok{(}\StringTok{"g\_pi"}\NormalTok{), }\FloatTok{0.025}\NormalTok{, }\AttributeTok{names =}\NormalTok{ F), }
                      \FunctionTok{quantile}\NormalTok{(fit\_SSL}\SpecialCharTok{$}\FunctionTok{draws}\NormalTok{(}\StringTok{"g\_pi"}\NormalTok{), }\FloatTok{0.975}\NormalTok{, }\AttributeTok{names =}\NormalTok{ F), }
                      \FunctionTok{max}\NormalTok{(fit\_SSL}\SpecialCharTok{$}\FunctionTok{summary}\NormalTok{()}\SpecialCharTok{$}\NormalTok{rhat), }\FunctionTok{ess\_calc3}\NormalTok{(fit\_SSL))}

\NormalTok{Result\_ALL1 }\OtherTok{\textless{}{-}} \FunctionTok{as.data.frame}\NormalTok{(Result\_ALL, }\AttributeTok{stringsAsFactors =}\NormalTok{ F)}
\FunctionTok{colnames}\NormalTok{(Result\_ALL1) }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{"MethodN"}\NormalTok{, }\StringTok{"Mean"}\NormalTok{, }\StringTok{"SD"}\NormalTok{, }\StringTok{"LCI"}\NormalTok{, }\StringTok{"UCI"}\NormalTok{, }\StringTok{"diag"}\NormalTok{, }\StringTok{"ESS"}\NormalTok{)}
\NormalTok{Result\_ALL1 }\OtherTok{\textless{}{-}}\NormalTok{ Result\_ALL1 }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{mutate}\NormalTok{(}\AttributeTok{Range =}\NormalTok{ (UCI }\SpecialCharTok{{-}}\NormalTok{ LCI)) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{Method =} \FunctionTok{case\_when}\NormalTok{(}
\NormalTok{    MethodN }\SpecialCharTok{==} \DecValTok{1} \SpecialCharTok{\textasciitilde{}} \StringTok{"CD"}\NormalTok{,}
\NormalTok{    MethodN }\SpecialCharTok{==} \DecValTok{2} \SpecialCharTok{\textasciitilde{}} \StringTok{"PD"}\NormalTok{,}
\NormalTok{    MethodN }\SpecialCharTok{==} \DecValTok{3} \SpecialCharTok{\textasciitilde{}} \StringTok{"EX"}\NormalTok{,}
\NormalTok{    MethodN }\SpecialCharTok{==} \DecValTok{4} \SpecialCharTok{\textasciitilde{}} \StringTok{"EXNEX"}\NormalTok{,}
\NormalTok{    MethodN }\SpecialCharTok{==} \DecValTok{5} \SpecialCharTok{\textasciitilde{}} \StringTok{"DPMEX"}\NormalTok{,}
\NormalTok{    MethodN }\SpecialCharTok{==} \DecValTok{6} \SpecialCharTok{\textasciitilde{}} \StringTok{"DMPP"}\NormalTok{,}
\NormalTok{    MethodN }\SpecialCharTok{==} \DecValTok{7} \SpecialCharTok{\textasciitilde{}} \StringTok{"UIP"}\NormalTok{,}
\NormalTok{    MethodN }\SpecialCharTok{==} \DecValTok{8} \SpecialCharTok{\textasciitilde{}} \StringTok{"PBM{-}HS"}\NormalTok{,}
\NormalTok{    MethodN }\SpecialCharTok{==} \DecValTok{9} \SpecialCharTok{\textasciitilde{}} \StringTok{"PBM{-}DL"}\NormalTok{,}
\NormalTok{    MethodN }\SpecialCharTok{==} \DecValTok{10} \SpecialCharTok{\textasciitilde{}} \StringTok{"PBM{-}SS"}\NormalTok{,}
\NormalTok{    MethodN }\SpecialCharTok{==} \DecValTok{11} \SpecialCharTok{\textasciitilde{}} \StringTok{"PBM{-}SSL"}\NormalTok{,}
    \ConstantTok{TRUE} \SpecialCharTok{\textasciitilde{}} \StringTok{""}
\NormalTok{  )) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{Mean1 =}\NormalTok{ Mean }\SpecialCharTok{*} \DecValTok{100}\NormalTok{, }\AttributeTok{SD1 =}\NormalTok{ SD }\SpecialCharTok{*} \DecValTok{100}\NormalTok{, }
         \AttributeTok{LCI1 =}\NormalTok{ LCI }\SpecialCharTok{*} \DecValTok{100}\NormalTok{, }\AttributeTok{UCI1 =}\NormalTok{ UCI }\SpecialCharTok{*} \DecValTok{100}\NormalTok{,}
         \AttributeTok{CI1 =} \FunctionTok{paste0}\NormalTok{(}\StringTok{"("}\NormalTok{, }\FunctionTok{format}\NormalTok{(}\FunctionTok{round}\NormalTok{(LCI }\SpecialCharTok{*} \DecValTok{100}\NormalTok{, }\AttributeTok{digits =} \DecValTok{1}\NormalTok{), }\AttributeTok{nsmall =} \DecValTok{1}\NormalTok{), }\StringTok{", "}\NormalTok{,}
                      \FunctionTok{format}\NormalTok{(}\FunctionTok{round}\NormalTok{(UCI }\SpecialCharTok{*} \DecValTok{100}\NormalTok{, }\AttributeTok{digits =} \DecValTok{1}\NormalTok{), }\AttributeTok{nsmall =} \DecValTok{1}\NormalTok{), }\StringTok{")"}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{EHSS1 =} \FunctionTok{if\_else}\NormalTok{(MethodN }\SpecialCharTok{\%in\%} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{2}\NormalTok{), }\StringTok{""}\NormalTok{, }
                         \FunctionTok{format}\NormalTok{(}\FunctionTok{round}\NormalTok{(ESS }\SpecialCharTok{{-}}\NormalTok{ n\_CC, }\AttributeTok{digits =} \DecValTok{1}\NormalTok{), }\AttributeTok{nsmall =} \DecValTok{1}\NormalTok{))) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{select}\NormalTok{(}\FunctionTok{c}\NormalTok{(Method, Mean1, SD1, LCI1, UCI1, CI1, EHSS1)) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{case =} \StringTok{"1"}\NormalTok{)}

\NormalTok{Result\_ALL1}\SpecialCharTok{$}\NormalTok{Method }\OtherTok{\textless{}{-}} \FunctionTok{factor}\NormalTok{(Result\_ALL1}\SpecialCharTok{$}\NormalTok{Method, }
        \AttributeTok{levels =} \FunctionTok{rev}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\StringTok{"CD"}\NormalTok{, }\StringTok{"PD"}\NormalTok{, }\StringTok{"EX"}\NormalTok{, }\StringTok{"EXNEX"}\NormalTok{, }\StringTok{"DPMEX"}\NormalTok{, }\StringTok{"DMPP"}\NormalTok{, }\StringTok{"UIP"}\NormalTok{, }
                       \StringTok{"PBM{-}HS"}\NormalTok{, }\StringTok{"PBM{-}DL"}\NormalTok{, }\StringTok{"PBM{-}SS"}\NormalTok{, }\StringTok{"PBM{-}SSL"}\NormalTok{)))}
\end{Highlighting}
\end{Shaded}

\hypertarget{drawing-drawing-posterior-distributions-of-beta_rm-h_k-for-case-1}{%
\subsection{\texorpdfstring{Drawing drawing posterior distributions of
\(\beta_{{\rm H}_k}\) for Case
1}{Drawing drawing posterior distributions of \textbackslash beta\_\{\{\textbackslash rm H\}\_k\} for Case 1}}\label{drawing-drawing-posterior-distributions-of-beta_rm-h_k-for-case-1}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{fig\_HS }\OtherTok{\textless{}{-}} \FunctionTok{beta\_fig}\NormalTok{(fit\_HS, }\StringTok{"PBM{-}HS"}\NormalTok{)}
\NormalTok{fig\_DL }\OtherTok{\textless{}{-}} \FunctionTok{beta\_fig}\NormalTok{(fit\_DL, }\StringTok{"PBM{-}DL"}\NormalTok{)}
\NormalTok{fig\_SS }\OtherTok{\textless{}{-}} \FunctionTok{beta\_fig}\NormalTok{(fit\_SS, }\StringTok{"PBM{-}SS"}\NormalTok{)}
\NormalTok{fig\_SSL }\OtherTok{\textless{}{-}} \FunctionTok{beta\_fig}\NormalTok{(fit\_SSL, }\StringTok{"PBM{-}SSL"}\NormalTok{)}

\NormalTok{fig\_case1 }\OtherTok{\textless{}{-}} \FunctionTok{ggarrange}\NormalTok{(fig\_HS, fig\_DL, fig\_SS, fig\_SSL, }
                       \AttributeTok{nrow =} \DecValTok{4}\NormalTok{, }\AttributeTok{common.legend =} \ConstantTok{TRUE}\NormalTok{, }\AttributeTok{legend =} \StringTok{"bottom"}\NormalTok{)}

\FunctionTok{print}\NormalTok{(fig\_case1)}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics{Case_Study_files/figure-latex/unnamed-chunk-7-1} \end{center}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggsave}\NormalTok{(}\StringTok{"Beta\_Case1.pdf"}\NormalTok{, fig\_case1, }\AttributeTok{width =} \DecValTok{9}\NormalTok{, }\AttributeTok{height =} \DecValTok{12}\NormalTok{ , }\AttributeTok{bg =} \StringTok{"white"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\hypertarget{case-study-2-artificial-data}{%
\section{Case study 2 (artificial
data)}\label{case-study-2-artificial-data}}

\hypertarget{datasets-1}{%
\subsection{Datasets}\label{datasets-1}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{n\_h }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{107}\NormalTok{, }\DecValTok{44}\NormalTok{, }\DecValTok{51}\NormalTok{, }\DecValTok{39}\NormalTok{, }\DecValTok{139}\NormalTok{, }\DecValTok{20}\NormalTok{, }\DecValTok{78}\NormalTok{, }\DecValTok{35}\NormalTok{)}
\NormalTok{x\_h }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{( }\DecValTok{23}\NormalTok{, }\DecValTok{12}\NormalTok{, }\DecValTok{31}\NormalTok{,  }\DecValTok{9}\NormalTok{,  }\DecValTok{39}\NormalTok{,  }\DecValTok{6}\NormalTok{,  }\DecValTok{9}\NormalTok{, }\DecValTok{10}\NormalTok{)}
\NormalTok{n\_CC }\OtherTok{\textless{}{-}} \DecValTok{6}
\NormalTok{x\_CC }\OtherTok{\textless{}{-}} \DecValTok{1}
\NormalTok{n\_CT }\OtherTok{\textless{}{-}} \DecValTok{23}
\NormalTok{x\_CT }\OtherTok{\textless{}{-}} \DecValTok{14}

\NormalTok{Historical }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}
  \AttributeTok{N =}\NormalTok{ n\_h, }
  \AttributeTok{X =}\NormalTok{ x\_h}
\NormalTok{)}

\NormalTok{Current }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}
  \AttributeTok{TRT =} \FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{),}
  \AttributeTok{N =} \FunctionTok{c}\NormalTok{(n\_CC, n\_CT),}
  \AttributeTok{X =} \FunctionTok{c}\NormalTok{(x\_CC, x\_CT)}
\NormalTok{)}

\NormalTok{Data\_all }\OtherTok{\textless{}{-}} \FunctionTok{list}\NormalTok{(}\AttributeTok{Historical =}\NormalTok{ Historical, }\AttributeTok{Current =}\NormalTok{ Current)}
\NormalTok{ANA }\OtherTok{\textless{}{-}} \FunctionTok{list}\NormalTok{(}\AttributeTok{H =} \FunctionTok{length}\NormalTok{(Data\_all}\SpecialCharTok{$}\NormalTok{Historical[,}\StringTok{"N"}\NormalTok{]),}
            \AttributeTok{x\_h =}\NormalTok{ Data\_all}\SpecialCharTok{$}\NormalTok{Historical[,}\StringTok{"X"}\NormalTok{], }\AttributeTok{n\_h =}\NormalTok{ Data\_all}\SpecialCharTok{$}\NormalTok{Historical[,}\StringTok{"N"}\NormalTok{], }
            \AttributeTok{x\_CC =}\NormalTok{ Data\_all}\SpecialCharTok{$}\NormalTok{Current}\SpecialCharTok{$}\NormalTok{X[}\DecValTok{1}\NormalTok{], }\AttributeTok{n\_CC =}\NormalTok{ Data\_all}\SpecialCharTok{$}\NormalTok{Current}\SpecialCharTok{$}\NormalTok{N[}\DecValTok{1}\NormalTok{], }
            \AttributeTok{x\_CT =}\NormalTok{ Data\_all}\SpecialCharTok{$}\NormalTok{Current}\SpecialCharTok{$}\NormalTok{X[}\DecValTok{2}\NormalTok{], }\AttributeTok{n\_CT =}\NormalTok{ Data\_all}\SpecialCharTok{$}\NormalTok{Current}\SpecialCharTok{$}\NormalTok{N[}\DecValTok{2}\NormalTok{], }
            \AttributeTok{betascale =} \DecValTok{1}\NormalTok{, }\AttributeTok{nu =} \DecValTok{1}\NormalTok{, }\AttributeTok{C =} \DecValTok{10}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\hypertarget{mcmc-fitting-1}{%
\subsection{MCMC fitting}\label{mcmc-fitting-1}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{fit\_Current  }\OtherTok{\textless{}{-}}\NormalTok{ Current\_stan}\SpecialCharTok{$}\FunctionTok{sample}\NormalTok{(}\AttributeTok{data =}\NormalTok{ ANA, }\AttributeTok{seed =} \DecValTok{999}\NormalTok{, }\AttributeTok{chains =} \DecValTok{4}\NormalTok{, }
        \AttributeTok{parallel\_chains =} \DecValTok{4}\NormalTok{, }\AttributeTok{iter\_warmup =} \DecValTok{4000}\NormalTok{, }\AttributeTok{iter\_sampling =} \DecValTok{4000}\NormalTok{, }\AttributeTok{refresh =} \DecValTok{0}\NormalTok{)}

\NormalTok{fit\_Pooled }\OtherTok{\textless{}{-}}\NormalTok{ Pooled\_stan}\SpecialCharTok{$}\FunctionTok{sample}\NormalTok{(}\AttributeTok{data =}\NormalTok{ ANA, }\AttributeTok{seed =} \DecValTok{999}\NormalTok{, }\AttributeTok{chains =} \DecValTok{4}\NormalTok{, }
        \AttributeTok{parallel\_chains =} \DecValTok{4}\NormalTok{, }\AttributeTok{iter\_warmup =} \DecValTok{4000}\NormalTok{, }\AttributeTok{iter\_sampling =} \DecValTok{4000}\NormalTok{, }\AttributeTok{refresh =} \DecValTok{0}\NormalTok{)}

\NormalTok{fit\_EX     }\OtherTok{\textless{}{-}}\NormalTok{ EX\_stan}\SpecialCharTok{$}\FunctionTok{sample}\NormalTok{(}\AttributeTok{data =}\NormalTok{ ANA, }\AttributeTok{seed =} \DecValTok{999}\NormalTok{, }\AttributeTok{chains =} \DecValTok{4}\NormalTok{, }
        \AttributeTok{parallel\_chains =} \DecValTok{4}\NormalTok{, }\AttributeTok{iter\_warmup =} \DecValTok{4000}\NormalTok{, }\AttributeTok{iter\_sampling =} \DecValTok{4000}\NormalTok{, }
        \AttributeTok{adapt\_delta =} \FloatTok{0.9}\NormalTok{, }\AttributeTok{refresh =} \DecValTok{0}\NormalTok{)}

\NormalTok{fit\_EXNEX  }\OtherTok{\textless{}{-}}\NormalTok{ EXNEX\_stan}\SpecialCharTok{$}\FunctionTok{sample}\NormalTok{(}\AttributeTok{data =}\NormalTok{ ANA, }\AttributeTok{seed =} \DecValTok{999}\NormalTok{, }\AttributeTok{chains =} \DecValTok{4}\NormalTok{, }
        \AttributeTok{parallel\_chains =} \DecValTok{4}\NormalTok{, }\AttributeTok{iter\_warmup =} \DecValTok{4000}\NormalTok{, }\AttributeTok{iter\_sampling =} \DecValTok{4000}\NormalTok{, }
        \AttributeTok{adapt\_delta =} \FloatTok{0.9}\NormalTok{, }\AttributeTok{refresh =} \DecValTok{0}\NormalTok{)}

\NormalTok{fit\_DPMEX  }\OtherTok{\textless{}{-}}\NormalTok{ DPMEX\_stan}\SpecialCharTok{$}\FunctionTok{sample}\NormalTok{(}\AttributeTok{data =}\NormalTok{ ANA, }\AttributeTok{seed =} \DecValTok{999}\NormalTok{, }\AttributeTok{chains =} \DecValTok{4}\NormalTok{, }
        \AttributeTok{parallel\_chains =} \DecValTok{4}\NormalTok{, }\AttributeTok{iter\_warmup =} \DecValTok{4000}\NormalTok{, }\AttributeTok{iter\_sampling =} \DecValTok{6000}\NormalTok{, }
        \AttributeTok{adapt\_delta =} \FloatTok{0.95}\NormalTok{, }\AttributeTok{refresh =} \DecValTok{0}\NormalTok{)}

\NormalTok{fit\_DMPP   }\OtherTok{\textless{}{-}}\NormalTok{ DMPP\_stan}\SpecialCharTok{$}\FunctionTok{sample}\NormalTok{(}\AttributeTok{data =}\NormalTok{ ANA, }\AttributeTok{seed =} \DecValTok{999}\NormalTok{, }\AttributeTok{chains =} \DecValTok{4}\NormalTok{, }
        \AttributeTok{parallel\_chains =} \DecValTok{4}\NormalTok{, }\AttributeTok{iter\_warmup =} \DecValTok{4000}\NormalTok{, }\AttributeTok{iter\_sampling =} \DecValTok{6000}\NormalTok{, }
        \AttributeTok{adapt\_delta =} \FloatTok{0.95}\NormalTok{, }\AttributeTok{refresh =} \DecValTok{0}\NormalTok{)}

\NormalTok{gamma\_h }\OtherTok{=} \FunctionTok{rep}\NormalTok{(}\ConstantTok{NA}\NormalTok{, }\FunctionTok{length}\NormalTok{(Data\_all}\SpecialCharTok{$}\NormalTok{Historical[,}\StringTok{"N"}\NormalTok{]))}
\ControlFlowTok{for}\NormalTok{(h }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\FunctionTok{length}\NormalTok{(Data\_all}\SpecialCharTok{$}\NormalTok{Historical[,}\StringTok{"N"}\NormalTok{]))\{}
\NormalTok{  gamma\_h[h] }\OtherTok{=} \FunctionTok{min}\NormalTok{(}\DecValTok{1}\NormalTok{, Data\_all}\SpecialCharTok{$}\NormalTok{Historical[,}\StringTok{"N"}\NormalTok{][h] }\SpecialCharTok{/}\NormalTok{ Data\_all}\SpecialCharTok{$}\NormalTok{Current}\SpecialCharTok{$}\NormalTok{N[}\DecValTok{1}\NormalTok{])}
\NormalTok{\}}

\NormalTok{theta\_h }\OtherTok{\textless{}{-}} \FunctionTok{rep}\NormalTok{(}\ConstantTok{NA}\NormalTok{, }\FunctionTok{length}\NormalTok{(n\_h))}
\NormalTok{I\_U }\OtherTok{\textless{}{-}} \FunctionTok{rep}\NormalTok{(}\ConstantTok{NA}\NormalTok{, }\FunctionTok{length}\NormalTok{(n\_h))}
\ControlFlowTok{for}\NormalTok{(h }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\FunctionTok{length}\NormalTok{(n\_h))\{}
\NormalTok{  theta\_h[h] }\OtherTok{=}\NormalTok{ x\_h[h] }\SpecialCharTok{*} \FloatTok{1.0} \SpecialCharTok{/}\NormalTok{ n\_h[h];}
\NormalTok{  I\_U[h] }\OtherTok{=} \DecValTok{1} \SpecialCharTok{/}\NormalTok{ (theta\_h[h] }\SpecialCharTok{*}\NormalTok{ (}\DecValTok{1} \SpecialCharTok{{-}}\NormalTok{ theta\_h[h]));}
\NormalTok{\}}

\NormalTok{ANA\_UIP }\OtherTok{\textless{}{-}} \FunctionTok{list}\NormalTok{(}\AttributeTok{H =} \FunctionTok{length}\NormalTok{(Data\_all}\SpecialCharTok{$}\NormalTok{Historical[,}\StringTok{"N"}\NormalTok{]), }
                \AttributeTok{x\_h =}\NormalTok{ Data\_all}\SpecialCharTok{$}\NormalTok{Historical}\SpecialCharTok{$}\NormalTok{X, }\AttributeTok{n\_h =}\NormalTok{ Data\_all}\SpecialCharTok{$}\NormalTok{Historical}\SpecialCharTok{$}\NormalTok{N, }
                \AttributeTok{x\_CC =}\NormalTok{ Data\_all}\SpecialCharTok{$}\NormalTok{Current}\SpecialCharTok{$}\NormalTok{X[}\DecValTok{1}\NormalTok{], }\AttributeTok{n\_CC =}\NormalTok{ Data\_all}\SpecialCharTok{$}\NormalTok{Current}\SpecialCharTok{$}\NormalTok{N[}\DecValTok{1}\NormalTok{], }
                \AttributeTok{x\_CT =}\NormalTok{ Data\_all}\SpecialCharTok{$}\NormalTok{Current}\SpecialCharTok{$}\NormalTok{X[}\DecValTok{2}\NormalTok{], }\AttributeTok{n\_CT =}\NormalTok{ Data\_all}\SpecialCharTok{$}\NormalTok{Current}\SpecialCharTok{$}\NormalTok{N[}\DecValTok{2}\NormalTok{], }
                \AttributeTok{gamma\_h =}\NormalTok{ gamma\_h, }\AttributeTok{theta\_h =}\NormalTok{ theta\_h, }\AttributeTok{I\_U =}\NormalTok{ I\_U)}

\NormalTok{fit\_UIPDir  }\OtherTok{\textless{}{-}}\NormalTok{ UIPDir\_stan}\SpecialCharTok{$}\FunctionTok{sample}\NormalTok{(}\AttributeTok{data =}\NormalTok{ ANA\_UIP, }\AttributeTok{seed =} \DecValTok{999}\NormalTok{, }\AttributeTok{chains =} \DecValTok{4}\NormalTok{, }
        \AttributeTok{parallel\_chains =} \DecValTok{4}\NormalTok{, }\AttributeTok{iter\_warmup =} \DecValTok{4000}\NormalTok{, }\AttributeTok{iter\_sampling =} \DecValTok{8000}\NormalTok{, }
        \AttributeTok{adapt\_delta =} \FloatTok{0.999}\NormalTok{, }\AttributeTok{max\_treedepth =} \DecValTok{12}\NormalTok{, }\AttributeTok{refresh =} \DecValTok{0}\NormalTok{)}


\NormalTok{fit\_HS     }\OtherTok{\textless{}{-}}\NormalTok{ HS\_stan}\SpecialCharTok{$}\FunctionTok{sample}\NormalTok{(}\AttributeTok{data =}\NormalTok{ ANA, }\AttributeTok{seed =} \DecValTok{999}\NormalTok{, }\AttributeTok{chains =} \DecValTok{4}\NormalTok{, }
        \AttributeTok{parallel\_chains =} \DecValTok{4}\NormalTok{, }\AttributeTok{iter\_warmup =} \DecValTok{4000}\NormalTok{, }\AttributeTok{iter\_sampling =} \DecValTok{12000}\NormalTok{, }
        \AttributeTok{adapt\_delta =} \FloatTok{0.999}\NormalTok{, }\AttributeTok{refresh =} \DecValTok{0}\NormalTok{)}

\NormalTok{ANA\_DL }\OtherTok{\textless{}{-}} \FunctionTok{list}\NormalTok{(}\AttributeTok{H =} \FunctionTok{length}\NormalTok{(Data\_all}\SpecialCharTok{$}\NormalTok{Historical[,}\StringTok{"N"}\NormalTok{]), }
               \AttributeTok{x\_h =}\NormalTok{ Data\_all}\SpecialCharTok{$}\NormalTok{Historical[,}\StringTok{"X"}\NormalTok{], }\AttributeTok{n\_h =}\NormalTok{ Data\_all}\SpecialCharTok{$}\NormalTok{Historical[,}\StringTok{"N"}\NormalTok{], }
               \AttributeTok{x\_CC =}\NormalTok{ Data\_all}\SpecialCharTok{$}\NormalTok{Current}\SpecialCharTok{$}\NormalTok{X[}\DecValTok{1}\NormalTok{], }\AttributeTok{n\_CC =}\NormalTok{ Data\_all}\SpecialCharTok{$}\NormalTok{Current}\SpecialCharTok{$}\NormalTok{N[}\DecValTok{1}\NormalTok{], }
               \AttributeTok{x\_CT =}\NormalTok{ Data\_all}\SpecialCharTok{$}\NormalTok{Current}\SpecialCharTok{$}\NormalTok{X[}\DecValTok{2}\NormalTok{], }\AttributeTok{n\_CT =}\NormalTok{ Data\_all}\SpecialCharTok{$}\NormalTok{Current}\SpecialCharTok{$}\NormalTok{N[}\DecValTok{2}\NormalTok{], }\AttributeTok{a =} \FloatTok{0.5}\NormalTok{)}
\NormalTok{fit\_DL }\OtherTok{\textless{}{-}}\NormalTok{ DL\_stan}\SpecialCharTok{$}\FunctionTok{sample}\NormalTok{(}\AttributeTok{data =}\NormalTok{ ANA\_DL, }\AttributeTok{seed =} \DecValTok{999}\NormalTok{, }\AttributeTok{chains =} \DecValTok{4}\NormalTok{, }
        \AttributeTok{parallel\_chains =} \DecValTok{4}\NormalTok{, }\AttributeTok{iter\_warmup =} \DecValTok{4000}\NormalTok{, }\AttributeTok{iter\_sampling =} \DecValTok{4000}\NormalTok{, }
        \AttributeTok{adapt\_delta =} \FloatTok{0.9}\NormalTok{, }\AttributeTok{refresh =} \DecValTok{0}\NormalTok{)}

\NormalTok{fit\_SS     }\OtherTok{\textless{}{-}}\NormalTok{ SS\_stan}\SpecialCharTok{$}\FunctionTok{sample}\NormalTok{(}\AttributeTok{data =}\NormalTok{ ANA, }\AttributeTok{seed =} \DecValTok{999}\NormalTok{, }\AttributeTok{chains =} \DecValTok{4}\NormalTok{, }
        \AttributeTok{parallel\_chains =} \DecValTok{4}\NormalTok{, }\AttributeTok{iter\_warmup =} \DecValTok{4000}\NormalTok{, }\AttributeTok{iter\_sampling =} \DecValTok{6000}\NormalTok{, }
        \AttributeTok{adapt\_delta =} \FloatTok{0.95}\NormalTok{, }\AttributeTok{max\_treedepth =} \DecValTok{12}\NormalTok{, }\AttributeTok{refresh =} \DecValTok{0}\NormalTok{)}

\NormalTok{ANA\_SSL }\OtherTok{\textless{}{-}} \FunctionTok{list}\NormalTok{(}\AttributeTok{H =} \FunctionTok{length}\NormalTok{(Data\_all}\SpecialCharTok{$}\NormalTok{Historical[,}\StringTok{"N"}\NormalTok{]), }
                \AttributeTok{x\_h =}\NormalTok{ Data\_all}\SpecialCharTok{$}\NormalTok{Historical[,}\StringTok{"X"}\NormalTok{], }\AttributeTok{n\_h =}\NormalTok{ Data\_all}\SpecialCharTok{$}\NormalTok{Historical[,}\StringTok{"N"}\NormalTok{], }
                \AttributeTok{x\_CC =}\NormalTok{ Data\_all}\SpecialCharTok{$}\NormalTok{Current}\SpecialCharTok{$}\NormalTok{X[}\DecValTok{1}\NormalTok{], }\AttributeTok{n\_CC =}\NormalTok{ Data\_all}\SpecialCharTok{$}\NormalTok{Current}\SpecialCharTok{$}\NormalTok{N[}\DecValTok{1}\NormalTok{], }
                \AttributeTok{x\_CT =}\NormalTok{ Data\_all}\SpecialCharTok{$}\NormalTok{Current}\SpecialCharTok{$}\NormalTok{X[}\DecValTok{2}\NormalTok{], }\AttributeTok{n\_CT =}\NormalTok{ Data\_all}\SpecialCharTok{$}\NormalTok{Current}\SpecialCharTok{$}\NormalTok{N[}\DecValTok{2}\NormalTok{], }
                \AttributeTok{lambda\_spike =} \FloatTok{0.1}\NormalTok{, }\AttributeTok{lambda\_slab =} \FloatTok{2.0}\NormalTok{)}
\NormalTok{fit\_SSL }\OtherTok{\textless{}{-}}\NormalTok{ SSL\_stan}\SpecialCharTok{$}\FunctionTok{sample}\NormalTok{(}\AttributeTok{data =}\NormalTok{ ANA\_SSL, }\AttributeTok{seed =} \DecValTok{999}\NormalTok{, }\AttributeTok{chains =} \DecValTok{4}\NormalTok{, }
        \AttributeTok{parallel\_chains =} \DecValTok{4}\NormalTok{, }\AttributeTok{iter\_warmup =} \DecValTok{4000}\NormalTok{, }\AttributeTok{iter\_sampling =} \DecValTok{4000}\NormalTok{, }
        \AttributeTok{adapt\_delta =} \FloatTok{0.9}\NormalTok{, }\AttributeTok{refresh =} \DecValTok{0}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\hypertarget{aggregate-posterior-distribution-1}{%
\subsection{Aggregate posterior
distribution}\label{aggregate-posterior-distribution-1}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{Result\_ALL }\OtherTok{\textless{}{-}} \FunctionTok{matrix}\NormalTok{(}\DecValTok{0}\NormalTok{, }\AttributeTok{nrow =} \DecValTok{11}\NormalTok{, }\AttributeTok{ncol =} \DecValTok{7}\NormalTok{)}
\NormalTok{Result\_ALL[}\DecValTok{1}\NormalTok{,]  }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\FunctionTok{mean}\NormalTok{(fit\_Current}\SpecialCharTok{$}\FunctionTok{draws}\NormalTok{(}\StringTok{"g\_pi"}\NormalTok{)), }\FunctionTok{sd}\NormalTok{(fit\_Current}\SpecialCharTok{$}\FunctionTok{draws}\NormalTok{(}\StringTok{"g\_pi"}\NormalTok{)), }
                     \FunctionTok{quantile}\NormalTok{(fit\_Current}\SpecialCharTok{$}\FunctionTok{draws}\NormalTok{(}\StringTok{"g\_pi"}\NormalTok{), }\FloatTok{0.025}\NormalTok{, }\AttributeTok{names =}\NormalTok{ F), }
                     \FunctionTok{quantile}\NormalTok{(fit\_Current}\SpecialCharTok{$}\FunctionTok{draws}\NormalTok{(}\StringTok{"g\_pi"}\NormalTok{), }\FloatTok{0.975}\NormalTok{, }\AttributeTok{names =}\NormalTok{ F), }
                     \FunctionTok{max}\NormalTok{(fit\_Current}\SpecialCharTok{$}\FunctionTok{summary}\NormalTok{()}\SpecialCharTok{$}\NormalTok{rhat), }\ConstantTok{NA}\NormalTok{)}
\NormalTok{Result\_ALL[}\DecValTok{2}\NormalTok{,]  }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{2}\NormalTok{, }\FunctionTok{mean}\NormalTok{(fit\_Pooled}\SpecialCharTok{$}\FunctionTok{draws}\NormalTok{(}\StringTok{"g\_pi"}\NormalTok{)), }\FunctionTok{sd}\NormalTok{(fit\_Pooled}\SpecialCharTok{$}\FunctionTok{draws}\NormalTok{(}\StringTok{"g\_pi"}\NormalTok{)), }
                     \FunctionTok{quantile}\NormalTok{(fit\_Pooled}\SpecialCharTok{$}\FunctionTok{draws}\NormalTok{(}\StringTok{"g\_pi"}\NormalTok{), }\FloatTok{0.025}\NormalTok{, }\AttributeTok{names =}\NormalTok{ F), }
                     \FunctionTok{quantile}\NormalTok{(fit\_Pooled}\SpecialCharTok{$}\FunctionTok{draws}\NormalTok{(}\StringTok{"g\_pi"}\NormalTok{), }\FloatTok{0.975}\NormalTok{, }\AttributeTok{names =}\NormalTok{ F), }
                     \FunctionTok{max}\NormalTok{(fit\_Pooled}\SpecialCharTok{$}\FunctionTok{summary}\NormalTok{()}\SpecialCharTok{$}\NormalTok{rhat), }\ConstantTok{NA}\NormalTok{)}
\NormalTok{Result\_ALL[}\DecValTok{3}\NormalTok{,]  }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{3}\NormalTok{, }\FunctionTok{mean}\NormalTok{(fit\_EX}\SpecialCharTok{$}\FunctionTok{draws}\NormalTok{(}\StringTok{"g\_pi"}\NormalTok{)), }\FunctionTok{sd}\NormalTok{(fit\_EX}\SpecialCharTok{$}\FunctionTok{draws}\NormalTok{(}\StringTok{"g\_pi"}\NormalTok{)), }
                     \FunctionTok{quantile}\NormalTok{(fit\_EX}\SpecialCharTok{$}\FunctionTok{draws}\NormalTok{(}\StringTok{"g\_pi"}\NormalTok{), }\FloatTok{0.025}\NormalTok{, }\AttributeTok{names =}\NormalTok{ F), }
                     \FunctionTok{quantile}\NormalTok{(fit\_EX}\SpecialCharTok{$}\FunctionTok{draws}\NormalTok{(}\StringTok{"g\_pi"}\NormalTok{), }\FloatTok{0.975}\NormalTok{, }\AttributeTok{names =}\NormalTok{ F), }
                     \FunctionTok{max}\NormalTok{(fit\_EX}\SpecialCharTok{$}\FunctionTok{summary}\NormalTok{()}\SpecialCharTok{$}\NormalTok{rhat), }\FunctionTok{ess\_calc3}\NormalTok{(fit\_EX))}
\NormalTok{Result\_ALL[}\DecValTok{4}\NormalTok{,]  }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{4}\NormalTok{, }\FunctionTok{mean}\NormalTok{(fit\_EXNEX}\SpecialCharTok{$}\FunctionTok{draws}\NormalTok{(}\StringTok{"g\_pi"}\NormalTok{)), }\FunctionTok{sd}\NormalTok{(fit\_EXNEX}\SpecialCharTok{$}\FunctionTok{draws}\NormalTok{(}\StringTok{"g\_pi"}\NormalTok{)), }
                     \FunctionTok{quantile}\NormalTok{(fit\_EXNEX}\SpecialCharTok{$}\FunctionTok{draws}\NormalTok{(}\StringTok{"g\_pi"}\NormalTok{), }\FloatTok{0.025}\NormalTok{, }\AttributeTok{names =}\NormalTok{ F), }
                     \FunctionTok{quantile}\NormalTok{(fit\_EXNEX}\SpecialCharTok{$}\FunctionTok{draws}\NormalTok{(}\StringTok{"g\_pi"}\NormalTok{), }\FloatTok{0.975}\NormalTok{, }\AttributeTok{names =}\NormalTok{ F), }
                     \FunctionTok{max}\NormalTok{(fit\_EXNEX}\SpecialCharTok{$}\FunctionTok{summary}\NormalTok{()}\SpecialCharTok{$}\NormalTok{rhat), }\FunctionTok{ess\_calc3}\NormalTok{(fit\_EXNEX))}
\NormalTok{Result\_ALL[}\DecValTok{5}\NormalTok{,]  }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{5}\NormalTok{, }\FunctionTok{mean}\NormalTok{(fit\_DPMEX}\SpecialCharTok{$}\FunctionTok{draws}\NormalTok{(}\StringTok{"g\_pi"}\NormalTok{)), }\FunctionTok{sd}\NormalTok{(fit\_DPMEX}\SpecialCharTok{$}\FunctionTok{draws}\NormalTok{(}\StringTok{"g\_pi"}\NormalTok{)), }
                     \FunctionTok{quantile}\NormalTok{(fit\_DPMEX}\SpecialCharTok{$}\FunctionTok{draws}\NormalTok{(}\StringTok{"g\_pi"}\NormalTok{), }\FloatTok{0.025}\NormalTok{, }\AttributeTok{names =}\NormalTok{ F), }
                     \FunctionTok{quantile}\NormalTok{(fit\_DPMEX}\SpecialCharTok{$}\FunctionTok{draws}\NormalTok{(}\StringTok{"g\_pi"}\NormalTok{), }\FloatTok{0.975}\NormalTok{, }\AttributeTok{names =}\NormalTok{ F), }
                     \FunctionTok{max}\NormalTok{(fit\_DPMEX}\SpecialCharTok{$}\FunctionTok{summary}\NormalTok{()}\SpecialCharTok{$}\NormalTok{rhat), }\FunctionTok{ess\_calc3}\NormalTok{(fit\_DPMEX))}
\NormalTok{Result\_ALL[}\DecValTok{6}\NormalTok{,]  }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{6}\NormalTok{, }\FunctionTok{mean}\NormalTok{(fit\_DMPP}\SpecialCharTok{$}\FunctionTok{draws}\NormalTok{(}\StringTok{"g\_pi"}\NormalTok{)), }\FunctionTok{sd}\NormalTok{(fit\_DMPP}\SpecialCharTok{$}\FunctionTok{draws}\NormalTok{(}\StringTok{"g\_pi"}\NormalTok{)), }
                     \FunctionTok{quantile}\NormalTok{(fit\_DMPP}\SpecialCharTok{$}\FunctionTok{draws}\NormalTok{(}\StringTok{"g\_pi"}\NormalTok{), }\FloatTok{0.025}\NormalTok{, }\AttributeTok{names =}\NormalTok{ F), }
                     \FunctionTok{quantile}\NormalTok{(fit\_DMPP}\SpecialCharTok{$}\FunctionTok{draws}\NormalTok{(}\StringTok{"g\_pi"}\NormalTok{), }\FloatTok{0.975}\NormalTok{, }\AttributeTok{names =}\NormalTok{ F), }
                     \FunctionTok{max}\NormalTok{(fit\_DMPP}\SpecialCharTok{$}\FunctionTok{summary}\NormalTok{()}\SpecialCharTok{$}\NormalTok{rhat), }\FunctionTok{ess\_calc3}\NormalTok{(fit\_DMPP))}
\NormalTok{Result\_ALL[}\DecValTok{7}\NormalTok{,]  }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{7}\NormalTok{, }\FunctionTok{mean}\NormalTok{(fit\_UIPDir}\SpecialCharTok{$}\FunctionTok{draws}\NormalTok{(}\StringTok{"g\_pi"}\NormalTok{)), }\FunctionTok{sd}\NormalTok{(fit\_UIPDir}\SpecialCharTok{$}\FunctionTok{draws}\NormalTok{(}\StringTok{"g\_pi"}\NormalTok{)), }
                     \FunctionTok{quantile}\NormalTok{(fit\_UIPDir}\SpecialCharTok{$}\FunctionTok{draws}\NormalTok{(}\StringTok{"g\_pi"}\NormalTok{), }\FloatTok{0.025}\NormalTok{, }\AttributeTok{names =}\NormalTok{ F), }
                     \FunctionTok{quantile}\NormalTok{(fit\_UIPDir}\SpecialCharTok{$}\FunctionTok{draws}\NormalTok{(}\StringTok{"g\_pi"}\NormalTok{), }\FloatTok{0.975}\NormalTok{, }\AttributeTok{names =}\NormalTok{ F), }
                     \FunctionTok{max}\NormalTok{(fit\_UIPDir}\SpecialCharTok{$}\FunctionTok{summary}\NormalTok{()}\SpecialCharTok{$}\NormalTok{rhat), }\FunctionTok{ess\_calc3}\NormalTok{(fit\_UIPDir))}
\NormalTok{Result\_ALL[}\DecValTok{8}\NormalTok{,]  }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{8}\NormalTok{, }\FunctionTok{mean}\NormalTok{(fit\_HS}\SpecialCharTok{$}\FunctionTok{draws}\NormalTok{(}\StringTok{"g\_pi"}\NormalTok{)), }\FunctionTok{sd}\NormalTok{(fit\_HS}\SpecialCharTok{$}\FunctionTok{draws}\NormalTok{(}\StringTok{"g\_pi"}\NormalTok{)), }
                     \FunctionTok{quantile}\NormalTok{(fit\_HS}\SpecialCharTok{$}\FunctionTok{draws}\NormalTok{(}\StringTok{"g\_pi"}\NormalTok{), }\FloatTok{0.025}\NormalTok{, }\AttributeTok{names =}\NormalTok{ F), }
                     \FunctionTok{quantile}\NormalTok{(fit\_HS}\SpecialCharTok{$}\FunctionTok{draws}\NormalTok{(}\StringTok{"g\_pi"}\NormalTok{), }\FloatTok{0.975}\NormalTok{, }\AttributeTok{names =}\NormalTok{ F), }
                     \FunctionTok{max}\NormalTok{(fit\_HS}\SpecialCharTok{$}\FunctionTok{summary}\NormalTok{()}\SpecialCharTok{$}\NormalTok{rhat) , }\FunctionTok{ess\_calc3}\NormalTok{(fit\_HS))}
\NormalTok{Result\_ALL[}\DecValTok{9}\NormalTok{,]  }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{9}\NormalTok{, }\FunctionTok{mean}\NormalTok{(fit\_DL}\SpecialCharTok{$}\FunctionTok{draws}\NormalTok{(}\StringTok{"g\_pi"}\NormalTok{)), }\FunctionTok{sd}\NormalTok{(fit\_DL}\SpecialCharTok{$}\FunctionTok{draws}\NormalTok{(}\StringTok{"g\_pi"}\NormalTok{)), }
                     \FunctionTok{quantile}\NormalTok{(fit\_DL}\SpecialCharTok{$}\FunctionTok{draws}\NormalTok{(}\StringTok{"g\_pi"}\NormalTok{), }\FloatTok{0.025}\NormalTok{, }\AttributeTok{names =}\NormalTok{ F), }
                     \FunctionTok{quantile}\NormalTok{(fit\_DL}\SpecialCharTok{$}\FunctionTok{draws}\NormalTok{(}\StringTok{"g\_pi"}\NormalTok{), }\FloatTok{0.975}\NormalTok{, }\AttributeTok{names =}\NormalTok{ F), }
                     \FunctionTok{max}\NormalTok{(fit\_DL}\SpecialCharTok{$}\FunctionTok{summary}\NormalTok{()}\SpecialCharTok{$}\NormalTok{rhat), }\FunctionTok{ess\_calc3}\NormalTok{(fit\_DL))}
\NormalTok{Result\_ALL[}\DecValTok{10}\NormalTok{,]  }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{10}\NormalTok{, }\FunctionTok{mean}\NormalTok{(fit\_SS}\SpecialCharTok{$}\FunctionTok{draws}\NormalTok{(}\StringTok{"g\_pi"}\NormalTok{)), }\FunctionTok{sd}\NormalTok{(fit\_SS}\SpecialCharTok{$}\FunctionTok{draws}\NormalTok{(}\StringTok{"g\_pi"}\NormalTok{)), }
                      \FunctionTok{quantile}\NormalTok{(fit\_SS}\SpecialCharTok{$}\FunctionTok{draws}\NormalTok{(}\StringTok{"g\_pi"}\NormalTok{), }\FloatTok{0.025}\NormalTok{, }\AttributeTok{names =}\NormalTok{ F), }
                      \FunctionTok{quantile}\NormalTok{(fit\_SS}\SpecialCharTok{$}\FunctionTok{draws}\NormalTok{(}\StringTok{"g\_pi"}\NormalTok{), }\FloatTok{0.975}\NormalTok{, }\AttributeTok{names =}\NormalTok{ F), }
                      \FunctionTok{max}\NormalTok{(fit\_SS}\SpecialCharTok{$}\FunctionTok{summary}\NormalTok{()}\SpecialCharTok{$}\NormalTok{rhat), }\FunctionTok{ess\_calc3}\NormalTok{(fit\_SS))}
\NormalTok{Result\_ALL[}\DecValTok{11}\NormalTok{,]  }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{11}\NormalTok{, }\FunctionTok{mean}\NormalTok{(fit\_SSL}\SpecialCharTok{$}\FunctionTok{draws}\NormalTok{(}\StringTok{"g\_pi"}\NormalTok{)), }\FunctionTok{sd}\NormalTok{(fit\_SSL}\SpecialCharTok{$}\FunctionTok{draws}\NormalTok{(}\StringTok{"g\_pi"}\NormalTok{)), }
                      \FunctionTok{quantile}\NormalTok{(fit\_SSL}\SpecialCharTok{$}\FunctionTok{draws}\NormalTok{(}\StringTok{"g\_pi"}\NormalTok{), }\FloatTok{0.025}\NormalTok{, }\AttributeTok{names =}\NormalTok{ F), }
                      \FunctionTok{quantile}\NormalTok{(fit\_SSL}\SpecialCharTok{$}\FunctionTok{draws}\NormalTok{(}\StringTok{"g\_pi"}\NormalTok{), }\FloatTok{0.975}\NormalTok{, }\AttributeTok{names =}\NormalTok{ F), }
                      \FunctionTok{max}\NormalTok{(fit\_SSL}\SpecialCharTok{$}\FunctionTok{summary}\NormalTok{()}\SpecialCharTok{$}\NormalTok{rhat), }\FunctionTok{ess\_calc3}\NormalTok{(fit\_SSL))}

\NormalTok{Result\_ALL2 }\OtherTok{\textless{}{-}} \FunctionTok{as.data.frame}\NormalTok{(Result\_ALL,}\AttributeTok{stringsAsFactors =}\NormalTok{ F)}
\FunctionTok{colnames}\NormalTok{(Result\_ALL2) }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{"MethodN"}\NormalTok{, }\StringTok{"Mean"}\NormalTok{, }\StringTok{"SD"}\NormalTok{, }\StringTok{"LCI"}\NormalTok{, }\StringTok{"UCI"}\NormalTok{, }\StringTok{"diag"}\NormalTok{, }\StringTok{"ESS"}\NormalTok{)}
\NormalTok{Result\_ALL2 }\OtherTok{\textless{}{-}}\NormalTok{ Result\_ALL2 }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{mutate}\NormalTok{(}\AttributeTok{Range =}\NormalTok{ (UCI }\SpecialCharTok{{-}}\NormalTok{ LCI)) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{Method =} \FunctionTok{case\_when}\NormalTok{(}
\NormalTok{    MethodN }\SpecialCharTok{==} \DecValTok{1} \SpecialCharTok{\textasciitilde{}} \StringTok{"CD"}\NormalTok{,}
\NormalTok{    MethodN }\SpecialCharTok{==} \DecValTok{2} \SpecialCharTok{\textasciitilde{}} \StringTok{"PD"}\NormalTok{,}
\NormalTok{    MethodN }\SpecialCharTok{==} \DecValTok{3} \SpecialCharTok{\textasciitilde{}} \StringTok{"EX"}\NormalTok{,}
\NormalTok{    MethodN }\SpecialCharTok{==} \DecValTok{4} \SpecialCharTok{\textasciitilde{}} \StringTok{"EXNEX"}\NormalTok{,}
\NormalTok{    MethodN }\SpecialCharTok{==} \DecValTok{5} \SpecialCharTok{\textasciitilde{}} \StringTok{"DPMEX"}\NormalTok{,}
\NormalTok{    MethodN }\SpecialCharTok{==} \DecValTok{6} \SpecialCharTok{\textasciitilde{}} \StringTok{"DMPP"}\NormalTok{,}
\NormalTok{    MethodN }\SpecialCharTok{==} \DecValTok{7} \SpecialCharTok{\textasciitilde{}} \StringTok{"UIP"}\NormalTok{,}
\NormalTok{    MethodN }\SpecialCharTok{==} \DecValTok{8} \SpecialCharTok{\textasciitilde{}} \StringTok{"PBM{-}HS"}\NormalTok{,}
\NormalTok{    MethodN }\SpecialCharTok{==} \DecValTok{9} \SpecialCharTok{\textasciitilde{}} \StringTok{"PBM{-}DL"}\NormalTok{,}
\NormalTok{    MethodN }\SpecialCharTok{==} \DecValTok{10} \SpecialCharTok{\textasciitilde{}} \StringTok{"PBM{-}SS"}\NormalTok{,}
\NormalTok{    MethodN }\SpecialCharTok{==} \DecValTok{11} \SpecialCharTok{\textasciitilde{}} \StringTok{"PBM{-}SSL"}\NormalTok{,}
    \ConstantTok{TRUE} \SpecialCharTok{\textasciitilde{}} \StringTok{""}
\NormalTok{  )) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{Mean1 =}\NormalTok{ Mean }\SpecialCharTok{*} \DecValTok{100}\NormalTok{, }\AttributeTok{SD1 =}\NormalTok{ SD }\SpecialCharTok{*} \DecValTok{100}\NormalTok{, }
         \AttributeTok{LCI1 =}\NormalTok{ LCI }\SpecialCharTok{*} \DecValTok{100}\NormalTok{, }\AttributeTok{UCI1 =}\NormalTok{ UCI }\SpecialCharTok{*} \DecValTok{100}\NormalTok{,}
         \AttributeTok{CI1 =} \FunctionTok{paste0}\NormalTok{(}\StringTok{"("}\NormalTok{, }\FunctionTok{format}\NormalTok{(}\FunctionTok{round}\NormalTok{(LCI }\SpecialCharTok{*} \DecValTok{100}\NormalTok{, }\AttributeTok{digits =} \DecValTok{1}\NormalTok{), }\AttributeTok{nsmall =} \DecValTok{1}\NormalTok{), }\StringTok{", "}\NormalTok{,}
                      \FunctionTok{format}\NormalTok{(}\FunctionTok{round}\NormalTok{(UCI }\SpecialCharTok{*} \DecValTok{100}\NormalTok{, }\AttributeTok{digits =} \DecValTok{1}\NormalTok{), }\AttributeTok{nsmall =} \DecValTok{1}\NormalTok{), }\StringTok{")"}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{EHSS1 =} \FunctionTok{if\_else}\NormalTok{(MethodN }\SpecialCharTok{\%in\%} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{2}\NormalTok{), }\StringTok{""}\NormalTok{, }
                         \FunctionTok{format}\NormalTok{(}\FunctionTok{round}\NormalTok{(ESS }\SpecialCharTok{{-}}\NormalTok{ n\_CC, }\AttributeTok{digits =} \DecValTok{1}\NormalTok{), }\AttributeTok{nsmall =} \DecValTok{1}\NormalTok{))) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{select}\NormalTok{(}\FunctionTok{c}\NormalTok{(Method, Mean1, SD1, LCI1, UCI1, CI1, EHSS1)) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{case =} \StringTok{"2"}\NormalTok{)}

\NormalTok{Result\_ALL2}\SpecialCharTok{$}\NormalTok{Method }\OtherTok{\textless{}{-}} \FunctionTok{factor}\NormalTok{(Result\_ALL2}\SpecialCharTok{$}\NormalTok{Method, }
        \AttributeTok{levels =} \FunctionTok{rev}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\StringTok{"CD"}\NormalTok{, }\StringTok{"PD"}\NormalTok{, }\StringTok{"EX"}\NormalTok{, }\StringTok{"EXNEX"}\NormalTok{, }\StringTok{"DPMEX"}\NormalTok{, }\StringTok{"DMPP"}\NormalTok{, }\StringTok{"UIP"}\NormalTok{, }
                       \StringTok{"PBM{-}HS"}\NormalTok{, }\StringTok{"PBM{-}DL"}\NormalTok{, }\StringTok{"PBM{-}SS"}\NormalTok{, }\StringTok{"PBM{-}SSL"}\NormalTok{)))}
\end{Highlighting}
\end{Shaded}

\hypertarget{drawing-drawing-posterior-distributions-of-beta_rm-h_k-for-case-2}{%
\subsection{\texorpdfstring{Drawing drawing posterior distributions of
\(\beta_{{\rm H}_k}\) for Case
2}{Drawing drawing posterior distributions of \textbackslash beta\_\{\{\textbackslash rm H\}\_k\} for Case 2}}\label{drawing-drawing-posterior-distributions-of-beta_rm-h_k-for-case-2}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{fig\_HS }\OtherTok{\textless{}{-}} \FunctionTok{beta\_fig}\NormalTok{(fit\_HS, }\StringTok{"PBM{-}HS"}\NormalTok{)}
\NormalTok{fig\_DL }\OtherTok{\textless{}{-}} \FunctionTok{beta\_fig}\NormalTok{(fit\_DL, }\StringTok{"PBM{-}DL"}\NormalTok{)}
\NormalTok{fig\_SS }\OtherTok{\textless{}{-}} \FunctionTok{beta\_fig}\NormalTok{(fit\_SS, }\StringTok{"PBM{-}SS"}\NormalTok{)}
\NormalTok{fig\_SSL }\OtherTok{\textless{}{-}} \FunctionTok{beta\_fig}\NormalTok{(fit\_SSL, }\StringTok{"PBM{-}SSL"}\NormalTok{)}

\NormalTok{fig\_case2 }\OtherTok{\textless{}{-}} \FunctionTok{ggarrange}\NormalTok{(fig\_HS, fig\_DL, fig\_SS, fig\_SSL, }\AttributeTok{nrow =} \DecValTok{4}\NormalTok{, }
                       \AttributeTok{common.legend =} \ConstantTok{TRUE}\NormalTok{, }\AttributeTok{legend =} \StringTok{"bottom"}\NormalTok{)}

\FunctionTok{print}\NormalTok{(fig\_case2)}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics{Case_Study_files/figure-latex/unnamed-chunk-11-1} \end{center}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggsave}\NormalTok{(}\StringTok{"Beta\_Case2.pdf"}\NormalTok{, fig\_case2, }\AttributeTok{width =} \DecValTok{9}\NormalTok{, }\AttributeTok{height =} \DecValTok{12}\NormalTok{ ,}\AttributeTok{bg =} \StringTok{"white"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\hypertarget{create-output}{%
\section{Create output}\label{create-output}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{Res\_ALL }\OtherTok{\textless{}{-}} \FunctionTok{rbind}\NormalTok{(Result\_ALL1, Result\_ALL2)}

\NormalTok{Res\_ALL\_out }\OtherTok{\textless{}{-}}\NormalTok{ Res\_ALL }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{select}\NormalTok{(}\SpecialCharTok{{-}}\FunctionTok{c}\NormalTok{(LCI1, UCI1)) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{pivot\_wider}\NormalTok{(}\AttributeTok{names\_from =}\NormalTok{ case, }\AttributeTok{values\_from =} \FunctionTok{c}\NormalTok{(Mean1, SD1, CI1, EHSS1), }
              \AttributeTok{names\_sep =} \StringTok{"\_"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{select}\NormalTok{(Method, Mean1\_1, SD1\_1, CI1\_1, EHSS1\_1, Mean1\_2, SD1\_2, CI1\_2, EHSS1\_2)}
\FunctionTok{write.csv}\NormalTok{(Res\_ALL\_out, }\AttributeTok{file =} \StringTok{"Result.csv"}\NormalTok{, }\AttributeTok{row.names =} \ConstantTok{FALSE}\NormalTok{)}

\FunctionTok{kable}\NormalTok{(Res\_ALL\_out, }\AttributeTok{align =} \FunctionTok{c}\NormalTok{(}\StringTok{"lrrcrrrcr"}\NormalTok{), }\AttributeTok{digits =} \DecValTok{1}\NormalTok{, }
      \AttributeTok{format =} \StringTok{"latex"}\NormalTok{, }\AttributeTok{escape =}\NormalTok{ F,}
      \AttributeTok{caption =} \StringTok{"Summary of posterior distributions of the treatment effect, $}\SpecialCharTok{\textbackslash{}\textbackslash{}}\StringTok{pi\_\{}\SpecialCharTok{\textbackslash{}\textbackslash{}}\StringTok{rm CT\}{-}}\SpecialCharTok{\textbackslash{}\textbackslash{}}\StringTok{pi\_\{}\SpecialCharTok{\textbackslash{}\textbackslash{}}\StringTok{rm CC\} (}\SpecialCharTok{\textbackslash{}\textbackslash{}}\StringTok{\%)$, for cases 1 (original dataset) and 2 (artificial dataset)."}\NormalTok{,}
      \AttributeTok{label =} \StringTok{"tab1"}\NormalTok{,}
      \AttributeTok{col.names =} \FunctionTok{c}\NormalTok{(}\StringTok{"Method"}\NormalTok{, }\StringTok{"Mean"}\NormalTok{, }\StringTok{"SD"}\NormalTok{, }\StringTok{"95}\SpecialCharTok{\textbackslash{}\textbackslash{}}\StringTok{\%CI"}\NormalTok{, }\StringTok{"EHSS"}\NormalTok{, }
                    \StringTok{"Mean"}\NormalTok{, }\StringTok{"SD"}\NormalTok{, }\StringTok{"95}\SpecialCharTok{\textbackslash{}\textbackslash{}}\StringTok{\%CI"}\NormalTok{, }\StringTok{"EHSS"}\NormalTok{),}
      \AttributeTok{row.names =} \ConstantTok{FALSE}\NormalTok{,}
      \AttributeTok{booktabs =}\NormalTok{ T, }\AttributeTok{linesep =} \StringTok{""}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%} 
      \FunctionTok{kable\_styling}\NormalTok{(}\AttributeTok{font\_size =} \DecValTok{11}\NormalTok{, }\AttributeTok{latex\_options =} \FunctionTok{c}\NormalTok{(}\StringTok{"hold\_position"}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%} 
      \FunctionTok{add\_footnote}\NormalTok{(}\StringTok{"SD: standard deviation; CI: credible interval; CD: current data analysis; PD: pooled data analysis; EX: full exchangeability MAC method; EXNEX: exchangeability{-}{-}non{-}exchangeability MAC method; DPMEX: Dirichlet process mixture of exchangeability MAC method; DMPP: dependent modified power prior; UIP: unit information prior; PBM{-}HS: potential bias model with horseshoe prior; PBM{-}DL: potential bias model with Dirichlet{-}{-}Laplace prior; PBM{-}SS: potential bias model with spike{-}and{-}slab prior; PBM{-}SSL: potential bias model with spike{-}and{-}slab Lasso prior."}\NormalTok{, }
      \AttributeTok{notation =} \StringTok{"none"}\NormalTok{, }\AttributeTok{threeparttable =}\NormalTok{ T) }\SpecialCharTok{\%\textgreater{}\%}
      \FunctionTok{add\_header\_above}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\StringTok{" "}\NormalTok{, }\StringTok{"Case 1"} \OtherTok{=} \DecValTok{4}\NormalTok{, }\StringTok{"Case 2"} \OtherTok{=} \DecValTok{4}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{table}[!h]

\begin{threeparttable}
\caption{\label{tab:tab1}Summary of posterior distributions of the treatment effect, $\pi_{\rm CT}-\pi_{\rm CC} (\%)$, for cases 1 (original dataset) and 2 (artificial dataset).}
\centering
\fontsize{11}{13}\selectfont
\begin{tabular}[t]{lrrcrrrcr}
\toprule
\multicolumn{1}{c}{ } & \multicolumn{4}{c}{Case 1} & \multicolumn{4}{c}{Case 2} \\
\cmidrule(l{3pt}r{3pt}){2-5} \cmidrule(l{3pt}r{3pt}){6-9}
Method & Mean & SD & 95\%CI & EHSS & Mean & SD & 95\%CI & EHSS\\
\midrule
CD & 44.3 & 17.1 & ( 4.7, 71.6) &  & 44.3 & 17.1 & ( 4.7, 71.6) & \\
PD & 36.2 & 10.0 & (16.0, 54.7) &  & 33.9 & 10.1 & (13.0, 52.7) & \\
EX & 36.7 & 12.1 & (12.0, 59.3) & 43.9 & 36.9 & 14.3 & ( 6.9, 62.9) & 11.8\\
EXNEX & 36.8 & 12.0 & (12.1, 59.1) & 42.0 & 36.6 & 14.2 & ( 7.1, 62.7) & 12.1\\
DPMEX & 37.1 & 11.8 & (12.2, 58.6) & 58.2 & 37.1 & 12.7 & ( 9.8, 59.5) & 45.2\\
DMPP & 36.3 & 10.4 & (15.6, 56.0) & 221.0 & 34.0 & 10.6 & (12.6, 53.8) & 210.8\\
UIP & 35.5 & 10.8 & (13.8, 55.6) & 118.6 & 33.2 & 11.3 & (10.3, 54.6) & 70.9\\
PBM-HS & 35.2 & 10.5 & (13.9, 54.6) & 217.9 & 36.0 & 10.5 & (14.6, 55.6) & 168.9\\
PBM-DL & 34.8 & 10.3 & (14.2, 54.0) & 255.5 & 35.7 & 10.2 & (14.7, 54.8) & 236.6\\
PBM-SS & 34.3 & 10.3 & (13.8, 53.5) & 263.0 & 35.5 & 10.3 & (14.7, 54.7) & 270.0\\
PBM-SSL & 34.6 & 10.4 & (13.4, 53.9) & 199.4 & 35.9 & 10.5 & (14.8, 55.6) & 206.8\\
\bottomrule
\end{tabular}
\begin{tablenotes}
\small
\item [] SD: standard deviation; CI: credible interval; CD: current data analysis; PD: pooled data analysis; EX: full exchangeability MAC method; EXNEX: exchangeability--non-exchangeability MAC method; DPMEX: Dirichlet process mixture of exchangeability MAC method; DMPP: dependent modified power prior; UIP: unit information prior; PBM-HS: potential bias model with horseshoe prior; PBM-DL: potential bias model with Dirichlet--Laplace prior; PBM-SS: potential bias model with spike-and-slab prior; PBM-SSL: potential bias model with spike-and-slab Lasso prior.
\end{tablenotes}
\end{threeparttable}
\end{table}

\hypertarget{drawing-forest-plot}{%
\subsection{Drawing forest plot}\label{drawing-forest-plot}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{labeli }\OtherTok{\textless{}{-}} \FunctionTok{as\_labeller}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\StringTok{"1"} \OtherTok{=} \StringTok{"Case 1"}\NormalTok{, }\StringTok{"2"} \OtherTok{=} \StringTok{"Case 2"}\NormalTok{))}

\NormalTok{Res\_ALL\_fig }\OtherTok{\textless{}{-}}\NormalTok{ Res\_ALL}
\NormalTok{Res\_ALL\_fig[Res\_ALL\_fig}\SpecialCharTok{$}\NormalTok{Method }\SpecialCharTok{==} \StringTok{"PD"}\NormalTok{, }\StringTok{"EHSS1"}\NormalTok{] }\OtherTok{\textless{}{-}} \StringTok{"EHSS"}

\NormalTok{Result\_fig }\OtherTok{\textless{}{-}} \FunctionTok{ggplot}\NormalTok{(Res\_ALL\_fig, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ Mean1, }\AttributeTok{y =}\NormalTok{ Method)) }\SpecialCharTok{+}
  \FunctionTok{xlab}\NormalTok{(}\StringTok{"Treatment effect in terms of the response rate (\%)"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{(}\AttributeTok{size =} \DecValTok{3}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{geom\_linerange}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{xmin =}\NormalTok{ LCI1, }\AttributeTok{xmax =}\NormalTok{ UCI1), }\AttributeTok{size =} \DecValTok{1}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{coord\_cartesian}\NormalTok{(}\AttributeTok{xlim =} \FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{80}\NormalTok{), }\AttributeTok{expand =}\NormalTok{ T) }\SpecialCharTok{+}
  \FunctionTok{geom\_text}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =} \DecValTok{70}\NormalTok{, }\AttributeTok{label =}\NormalTok{ EHSS1), }\AttributeTok{hjust =} \DecValTok{0}\NormalTok{, }\AttributeTok{size =} \DecValTok{4}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{theme}\NormalTok{(}
    \AttributeTok{plot.title =} \FunctionTok{element\_blank}\NormalTok{(),}
    \AttributeTok{axis.text.x =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{colour =} \StringTok{"black"}\NormalTok{, }\AttributeTok{size =} \DecValTok{10}\NormalTok{),}
    \AttributeTok{axis.text.y =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{colour =} \StringTok{"black"}\NormalTok{, }\AttributeTok{size =} \DecValTok{10}\NormalTok{),}
    \AttributeTok{axis.ticks.x =} \FunctionTok{element\_line}\NormalTok{(}\AttributeTok{colour =} \StringTok{"black"}\NormalTok{, }\AttributeTok{size =} \DecValTok{1}\NormalTok{),}
    \AttributeTok{axis.ticks.y =} \FunctionTok{element\_line}\NormalTok{(}\AttributeTok{colour =} \StringTok{"black"}\NormalTok{, }\AttributeTok{size =} \DecValTok{1}\NormalTok{),}
    \AttributeTok{axis.title.x =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{colour =} \StringTok{"black"}\NormalTok{, }\AttributeTok{size =} \DecValTok{16}\NormalTok{),}
    \AttributeTok{axis.title.y =} \FunctionTok{element\_blank}\NormalTok{(),}
    \AttributeTok{axis.line.x =} \FunctionTok{element\_line}\NormalTok{(}\AttributeTok{colour =} \StringTok{"\#000000"}\NormalTok{, }\AttributeTok{size =} \DecValTok{1}\NormalTok{, }
                          \AttributeTok{linetype =} \StringTok{"solid"}\NormalTok{, }\AttributeTok{lineend =} \StringTok{"round"}\NormalTok{),}
    \AttributeTok{axis.line.y =} \FunctionTok{element\_line}\NormalTok{(}\AttributeTok{colour =} \StringTok{"\#000000"}\NormalTok{, }\AttributeTok{size =} \DecValTok{1}\NormalTok{, }
                          \AttributeTok{linetype =} \StringTok{"solid"}\NormalTok{, }\AttributeTok{lineend =} \StringTok{"round"}\NormalTok{),}
    \AttributeTok{panel.background =} \FunctionTok{element\_rect}\NormalTok{(}\AttributeTok{fill =} \StringTok{"transparent"}\NormalTok{, }\AttributeTok{colour =} \ConstantTok{NA}\NormalTok{),}
    \AttributeTok{panel.border =} \FunctionTok{element\_blank}\NormalTok{(),}
    \AttributeTok{panel.grid =} \FunctionTok{element\_blank}\NormalTok{(),}
    \AttributeTok{panel.grid.major =} \FunctionTok{element\_blank}\NormalTok{(),}
    \AttributeTok{panel.grid.minor =} \FunctionTok{element\_blank}\NormalTok{(),}
    \AttributeTok{panel.grid.major.x =} \FunctionTok{element\_blank}\NormalTok{(),}
    \AttributeTok{panel.grid.major.y =} \FunctionTok{element\_blank}\NormalTok{(),}
    \AttributeTok{panel.grid.minor.x =} \FunctionTok{element\_blank}\NormalTok{(),}
    \AttributeTok{panel.grid.minor.y =} \FunctionTok{element\_blank}\NormalTok{()}
\NormalTok{  ) }\SpecialCharTok{+}
  \FunctionTok{facet\_grid}\NormalTok{( }\SpecialCharTok{\textasciitilde{}}\NormalTok{ case, }\AttributeTok{scales =} \StringTok{"fixed"}\NormalTok{, }\AttributeTok{space =} \StringTok{"free"}\NormalTok{, }
              \AttributeTok{labeller =}\NormalTok{ labeli, }\AttributeTok{switch =} \StringTok{"y"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{theme}\NormalTok{(}
    \AttributeTok{strip.placement.y =} \StringTok{"outside"}\NormalTok{,}
    \AttributeTok{strip.background =} \FunctionTok{element\_blank}\NormalTok{(),}
    \AttributeTok{strip.text.x =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{colour =} \StringTok{"black"}\NormalTok{, }\AttributeTok{size =} \DecValTok{16}\NormalTok{),}
    \AttributeTok{panel.spacing.y =} \FunctionTok{unit}\NormalTok{(}\FloatTok{1.5}\NormalTok{, }\StringTok{"lines"}\NormalTok{)}
\NormalTok{  )}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{print}\NormalTok{(Result\_fig)}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{Case_Study_files/figure-latex/unnamed-chunk-14-1} \end{center}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggsave}\NormalTok{(}\StringTok{"Result.pdf"}\NormalTok{, Result\_fig, }\AttributeTok{width =} \DecValTok{12}\NormalTok{, }\AttributeTok{height =} \DecValTok{8}\NormalTok{, }\AttributeTok{bg =} \StringTok{"white"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}


\end{document}
